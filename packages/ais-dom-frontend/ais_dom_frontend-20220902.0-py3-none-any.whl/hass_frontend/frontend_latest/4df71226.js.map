{"version":3,"file":"4df71226.js","mappings":";;AA+CA;;AAEA;AACA;AACA;;;AAKA;;AAEA;AACA;AACA;;AAKA;AACA;AAGA;AACA;AACA;AAGA;AAKA;AAJA;;;;;;;;;;;;;;;;AAjDA;;AC+EA;;AAKA;AAKA;;;AAMA;AAGA;;;AAIA;;AAWA;AACA;AAGA;;AAEA;AAEA;;AAGA;AACA;AACA;;AAEA;AAEA;;AAGA;AACA;AACA;;AAEA;AAEA;;AAGA;AACA;AACA;;AAEA;AAEA;;;AAKA;AAGA;;AAEA;AAIA;;AAIA;AACA;AACA;;;AAIA;;AAKA;AACA;AACA;;AAEA;AAKA;;AAKA;AACA;AACA;;AAEA;;;AAIA;;;AAMA;;AAGA;AAGA;AAOA;;AAEA;AAEA;;AAIA;AACA;;AAEA;;;;AAIA;;;AAMA;AAGA;;;;AAIA;AAGA;;AAEA;;;AAIA;;;;;;;;;;;;;;;;;;;;;;;;;;;AApOA;ACDA;;AAEA;AACA;;;AAGA;;;AAdA;;AAEA;;;;;;;;;;ACKA;AACA;AAEA;AAQA;AAEA;AAEA;AACA;;AAGA;AAEA;;AA7BA;;AAEA;;;;;;;ACiBA;;;AAGA;AACA;;AAKA;;AAKA;AACA;AACA;;;;;;AAxBA;;AAEA;;;;;;;;;AA1BA;ACoBA;AACA;;AATA;;AAEA;;;;;;;;;AA1BA;;ACoBA;;AAKA;;AAOA;AACA;AACA;;AAEA;;AAGA;AACA;;AAEA;;AAGA;;;;AAnDA;;ACwCA;;AAKA;AAOA;AACA;AACA;AAEA;AACA;AACA;;AAEA;AAMA;;;;;;AA1DA;ACmCA;;;AAGA;;AAEA;AACA;AAIA;;;AAlDA;;;;;;;;;;;;;;;;;;;;;;;;;AAAA","sources":["webpack://home-assistant-frontend/./src/components/entity/ha-entity-toggle.ts","webpack://home-assistant-frontend/./src/panels/lovelace/entity-rows/hui-media-player-entity-row.ts","webpack://home-assistant-frontend/./src/panels/lovelace/entity-rows/hui-scene-entity-row.ts","webpack://home-assistant-frontend/./src/panels/lovelace/entity-rows/hui-script-entity-row.ts","webpack://home-assistant-frontend/./src/panels/lovelace/entity-rows/hui-sensor-entity-row.ts","webpack://home-assistant-frontend/./src/panels/lovelace/entity-rows/hui-text-entity-row.ts","webpack://home-assistant-frontend/./src/panels/lovelace/entity-rows/hui-toggle-entity-row.ts","webpack://home-assistant-frontend/./src/panels/lovelace/special-rows/hui-attribute-row.ts","webpack://home-assistant-frontend/./src/panels/lovelace/special-rows/hui-button-row.ts"],"sourcesContent":["import { mdiFlash, mdiFlashOff } from \"@mdi/js\";\nimport { HassEntity } from \"home-assistant-js-websocket\";\nimport {\n  css,\n  CSSResultGroup,\n  html,\n  LitElement,\n  PropertyValues,\n  TemplateResult,\n} from \"lit\";\nimport { property, state } from \"lit/decorators\";\nimport { STATES_OFF } from \"../../common/const\";\nimport { computeStateDomain } from \"../../common/entity/compute_state_domain\";\nimport { computeStateName } from \"../../common/entity/compute_state_name\";\nimport { UNAVAILABLE, UNAVAILABLE_STATES, UNKNOWN } from \"../../data/entity\";\nimport { forwardHaptic } from \"../../data/haptics\";\nimport { HomeAssistant } from \"../../types\";\nimport \"../ha-formfield\";\nimport \"../ha-icon-button\";\nimport \"../ha-switch\";\n\nconst isOn = (stateObj?: HassEntity) =>\n  stateObj !== undefined &&\n  !STATES_OFF.includes(stateObj.state) &&\n  !UNAVAILABLE_STATES.includes(stateObj.state);\n\nexport class HaEntityToggle extends LitElement {\n  // hass is not a property so that we only re-render on stateObj changes\n  public hass?: HomeAssistant;\n\n  @property() public stateObj?: HassEntity;\n\n  @property() public label?: string;\n\n  @state() private _isOn = false;\n\n  protected render(): TemplateResult {\n    if (!this.stateObj) {\n      return html` <ha-switch disabled></ha-switch> `;\n    }\n\n    if (\n      this.stateObj.attributes.assumed_state ||\n      this.stateObj.state === UNKNOWN\n    ) {\n      return html`\n        <ha-icon-button\n          .label=${`Turn ${computeStateName(this.stateObj)} off`}\n          .path=${mdiFlashOff}\n          .disabled=${this.stateObj.state === UNAVAILABLE}\n          @click=${this._turnOff}\n          class=${!this._isOn && this.stateObj.state !== UNKNOWN\n            ? \"state-active\"\n            : \"\"}\n        ></ha-icon-button>\n        <ha-icon-button\n          .label=${`Turn ${computeStateName(this.stateObj)} on`}\n          .path=${mdiFlash}\n          .disabled=${this.stateObj.state === UNAVAILABLE}\n          @click=${this._turnOn}\n          class=${this._isOn ? \"state-active\" : \"\"}\n        ></ha-icon-button>\n      `;\n    }\n\n    const switchTemplate = html`<ha-switch\n      aria-label=${`Toggle ${computeStateName(this.stateObj)} ${\n        this._isOn ? \"off\" : \"on\"\n      }`}\n      .checked=${this._isOn}\n      .disabled=${this.stateObj.state === UNAVAILABLE}\n      @change=${this._toggleChanged}\n    ></ha-switch>`;\n\n    if (!this.label) {\n      return switchTemplate;\n    }\n\n    return html`\n      <ha-formfield .label=${this.label}>${switchTemplate}</ha-formfield>\n    `;\n  }\n\n  protected firstUpdated(changedProps) {\n    super.firstUpdated(changedProps);\n    this.addEventListener(\"click\", (ev) => ev.stopPropagation());\n  }\n\n  public willUpdate(changedProps: PropertyValues): void {\n    super.willUpdate(changedProps);\n    if (changedProps.has(\"stateObj\")) {\n      this._isOn = isOn(this.stateObj);\n    }\n  }\n\n  private _toggleChanged(ev) {\n    const newVal = ev.target.checked;\n\n    if (newVal !== this._isOn) {\n      this._callService(newVal);\n    }\n  }\n\n  private _turnOn() {\n    this._callService(true);\n  }\n\n  private _turnOff() {\n    this._callService(false);\n  }\n\n  // We will force a re-render after a successful call to re-sync the toggle\n  // with the state. It will be out of sync if our service call did not\n  // result in the entity to be turned on. Since the state is not changing,\n  // the resync is not called automatic.\n  private async _callService(turnOn): Promise<void> {\n    if (!this.hass || !this.stateObj) {\n      return;\n    }\n    forwardHaptic(\"light\");\n    const stateDomain = computeStateDomain(this.stateObj);\n    let serviceDomain;\n    let service;\n\n    if (stateDomain === \"lock\") {\n      serviceDomain = \"lock\";\n      service = turnOn ? \"unlock\" : \"lock\";\n    } else if (stateDomain === \"cover\") {\n      serviceDomain = \"cover\";\n      service = turnOn ? \"open_cover\" : \"close_cover\";\n    } else if (stateDomain === \"group\") {\n      serviceDomain = \"homeassistant\";\n      service = turnOn ? \"turn_on\" : \"turn_off\";\n    } else {\n      serviceDomain = stateDomain;\n      service = turnOn ? \"turn_on\" : \"turn_off\";\n    }\n\n    const currentState = this.stateObj;\n\n    // Optimistic update.\n    this._isOn = turnOn;\n\n    await this.hass.callService(serviceDomain, service, {\n      entity_id: this.stateObj.entity_id,\n    });\n\n    setTimeout(async () => {\n      // If after 2 seconds we have not received a state update\n      // reset the switch to it's original state.\n      if (this.stateObj === currentState) {\n        this._isOn = isOn(this.stateObj);\n      }\n    }, 2000);\n  }\n\n  static get styles(): CSSResultGroup {\n    return css`\n      :host {\n        white-space: nowrap;\n        min-width: 38px;\n      }\n      ha-icon-button {\n        --mdc-icon-button-size: 40px;\n        color: var(--ha-icon-button-inactive-color, var(--primary-text-color));\n        transition: color 0.5s;\n      }\n      ha-icon-button.state-active {\n        color: var(--ha-icon-button-active-color, var(--primary-color));\n      }\n      ha-switch {\n        padding: 13px 5px;\n      }\n    `;\n  }\n}\n\ncustomElements.define(\"ha-entity-toggle\", HaEntityToggle);\n","import {\n  mdiPause,\n  mdiPlay,\n  mdiPlayPause,\n  mdiPower,\n  mdiSkipNext,\n  mdiSkipPrevious,\n  mdiStop,\n  mdiVolumeHigh,\n  mdiVolumeMinus,\n  mdiVolumeOff,\n  mdiVolumePlus,\n} from \"@mdi/js\";\nimport { HassEntity } from \"home-assistant-js-websocket\";\nimport {\n  css,\n  CSSResultGroup,\n  html,\n  LitElement,\n  PropertyValues,\n  TemplateResult,\n} from \"lit\";\nimport { customElement, property, state } from \"lit/decorators\";\nimport { computeStateDisplay } from \"../../../common/entity/compute_state_display\";\nimport { supportsFeature } from \"../../../common/entity/supports-feature\";\nimport { computeRTLDirection } from \"../../../common/util/compute_rtl\";\nimport { debounce } from \"../../../common/util/debounce\";\nimport \"../../../components/ha-icon-button\";\nimport \"../../../components/ha-slider\";\nimport { UNAVAILABLE, UNAVAILABLE_STATES, UNKNOWN } from \"../../../data/entity\";\nimport {\n  computeMediaDescription,\n  ControlButton,\n  MediaPlayerEntity,\n  SUPPORT_NEXT_TRACK,\n  SUPPORT_PAUSE,\n  SUPPORT_PLAY,\n  SUPPORT_PREVIOUS_TRACK,\n  SUPPORT_STOP,\n  SUPPORT_TURN_OFF,\n  SUPPORT_TURN_ON,\n  SUPPORT_VOLUME_BUTTONS,\n  SUPPORT_VOLUME_MUTE,\n  SUPPORT_VOLUME_SET,\n} from \"../../../data/media-player\";\nimport type { HomeAssistant } from \"../../../types\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\nimport { installResizeObserver } from \"../common/install-resize-observer\";\nimport \"../components/hui-generic-entity-row\";\nimport { createEntityNotFoundWarning } from \"../components/hui-warning\";\nimport type { EntityConfig, LovelaceRow } from \"./types\";\n\n@customElement(\"hui-media-player-entity-row\")\nclass HuiMediaPlayerEntityRow extends LitElement implements LovelaceRow {\n  @property({ attribute: false }) public hass?: HomeAssistant;\n\n  @state() private _config?: EntityConfig;\n\n  @state() private _narrow?: boolean = false;\n\n  @state() private _veryNarrow?: boolean = false;\n\n  private _resizeObserver?: ResizeObserver;\n\n  public setConfig(config: EntityConfig): void {\n    if (!config || !config.entity) {\n      throw new Error(\"Entity must be specified\");\n    }\n\n    this._config = config;\n  }\n\n  public connectedCallback(): void {\n    super.connectedCallback();\n    this._attachObserver();\n  }\n\n  public disconnectedCallback(): void {\n    this._resizeObserver?.unobserve(this);\n  }\n\n  public willUpdate(): void {\n    if (!this.hasUpdated) {\n      this._measureCard();\n    }\n  }\n\n  protected firstUpdated(): void {\n    this._attachObserver();\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult {\n    if (!this.hass || !this._config) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity] as MediaPlayerEntity;\n\n    if (!stateObj) {\n      return html`\n        <hui-warning>\n          ${createEntityNotFoundWarning(this.hass, this._config.entity)}\n        </hui-warning>\n      `;\n    }\n\n    const entityState = stateObj.state;\n    const controlButton = this._computeControlButton(stateObj);\n    const assumedState = stateObj.attributes.assumed_state === true;\n\n    const buttons = html`\n      ${!this._narrow &&\n      (entityState === \"playing\" || assumedState) &&\n      supportsFeature(stateObj, SUPPORT_PREVIOUS_TRACK)\n        ? html`\n            <ha-icon-button\n              .path=${mdiSkipPrevious}\n              .label=${this.hass.localize(\n                \"ui.card.media_player.media_previous_track\"\n              )}\n              @click=${this._previousTrack}\n            ></ha-icon-button>\n          `\n        : \"\"}\n      ${!assumedState &&\n      ((entityState === \"playing\" &&\n        (supportsFeature(stateObj, SUPPORT_PAUSE) ||\n          supportsFeature(stateObj, SUPPORT_STOP))) ||\n        ((entityState === \"paused\" || entityState === \"idle\") &&\n          supportsFeature(stateObj, SUPPORT_PLAY)) ||\n        (entityState === \"on\" &&\n          (supportsFeature(stateObj, SUPPORT_PLAY) ||\n            supportsFeature(stateObj, SUPPORT_PAUSE))))\n        ? html`\n            <ha-icon-button\n              .path=${controlButton.icon}\n              .label=${this.hass.localize(\n                `ui.card.media_player.${controlButton.action}`\n              )}\n              @click=${this._playPauseStop}\n            ></ha-icon-button>\n          `\n        : \"\"}\n      ${assumedState && supportsFeature(stateObj, SUPPORT_PLAY)\n        ? html`\n            <ha-icon-button\n              .path=${mdiPlay}\n              .label=${this.hass.localize(`ui.card.media_player.media_play`)}\n              @click=${this._play}\n            ></ha-icon-button>\n          `\n        : \"\"}\n      ${assumedState && supportsFeature(stateObj, SUPPORT_PAUSE)\n        ? html`\n            <ha-icon-button\n              .path=${mdiPause}\n              .label=${this.hass.localize(`ui.card.media_player.media_pause`)}\n              @click=${this._pause}\n            ></ha-icon-button>\n          `\n        : \"\"}\n      ${assumedState && supportsFeature(stateObj, SUPPORT_STOP)\n        ? html`\n            <ha-icon-button\n              .path=${mdiStop}\n              .label=${this.hass.localize(`ui.card.media_player.media_stop`)}\n              @click=${this._stop}\n            ></ha-icon-button>\n          `\n        : \"\"}\n      ${(entityState === \"playing\" || assumedState) &&\n      supportsFeature(stateObj, SUPPORT_NEXT_TRACK)\n        ? html`\n            <ha-icon-button\n              .path=${mdiSkipNext}\n              .label=${this.hass.localize(\n                \"ui.card.media_player.media_next_track\"\n              )}\n              @click=${this._nextTrack}\n            ></ha-icon-button>\n          `\n        : \"\"}\n    `;\n\n    const mediaDescription = computeMediaDescription(stateObj);\n\n    return html`\n      <hui-generic-entity-row\n        .hass=${this.hass}\n        .config=${this._config}\n        .secondaryText=${mediaDescription ||\n        computeStateDisplay(this.hass.localize, stateObj, this.hass.locale)}\n      >\n        <div class=\"controls\">\n          ${supportsFeature(stateObj, SUPPORT_TURN_ON) &&\n          entityState === \"off\" &&\n          !UNAVAILABLE_STATES.includes(entityState)\n            ? html`\n                <ha-icon-button\n                  .path=${mdiPower}\n                  .label=${this.hass.localize(\"ui.card.media_player.turn_on\")}\n                  @click=${this._togglePower}\n                ></ha-icon-button>\n              `\n            : !supportsFeature(stateObj, SUPPORT_VOLUME_SET) &&\n              !supportsFeature(stateObj, SUPPORT_VOLUME_BUTTONS)\n            ? buttons\n            : \"\"}\n          ${supportsFeature(stateObj, SUPPORT_TURN_OFF) &&\n          entityState !== \"off\" &&\n          !UNAVAILABLE_STATES.includes(entityState)\n            ? html`\n                <ha-icon-button\n                  .path=${mdiPower}\n                  .label=${this.hass.localize(\"ui.card.media_player.turn_off\")}\n                  @click=${this._togglePower}\n                ></ha-icon-button>\n              `\n            : \"\"}\n        </div>\n      </hui-generic-entity-row>\n      ${(supportsFeature(stateObj, SUPPORT_VOLUME_SET) ||\n        supportsFeature(stateObj, SUPPORT_VOLUME_BUTTONS)) &&\n      ![UNAVAILABLE, UNKNOWN, \"off\"].includes(entityState)\n        ? html`\n            <div class=\"flex\">\n              <div class=\"volume\">\n                ${supportsFeature(stateObj, SUPPORT_VOLUME_MUTE)\n                  ? html`\n                      <ha-icon-button\n                        .path=${stateObj.attributes.is_volume_muted\n                          ? mdiVolumeOff\n                          : mdiVolumeHigh}\n                        .label=${this.hass.localize(\n                          `ui.card.media_player.${\n                            stateObj.attributes.is_volume_muted\n                              ? \"media_volume_mute\"\n                              : \"media_volume_unmute\"\n                          }`\n                        )}\n                        @click=${this._toggleMute}\n                      ></ha-icon-button>\n                    `\n                  : \"\"}\n                ${!this._veryNarrow &&\n                supportsFeature(stateObj, SUPPORT_VOLUME_SET)\n                  ? html`\n                      <ha-slider\n                        .dir=${computeRTLDirection(this.hass!)}\n                        .value=${Number(stateObj.attributes.volume_level) * 100}\n                        pin\n                        @change=${this._selectedValueChanged}\n                        ignore-bar-touch\n                        id=\"input\"\n                      ></ha-slider>\n                    `\n                  : !this._veryNarrow &&\n                    supportsFeature(stateObj, SUPPORT_VOLUME_BUTTONS)\n                  ? html`\n                      <ha-icon-button\n                        .path=${mdiVolumeMinus}\n                        .label=${this.hass.localize(\n                          \"ui.card.media_player.media_volume_down\"\n                        )}\n                        @click=${this._volumeDown}\n                      ></ha-icon-button>\n                      <ha-icon-button\n                        .path=${mdiVolumePlus}\n                        .label=${this.hass.localize(\n                          \"ui.card.media_player.media_volume_up\"\n                        )}\n                        @click=${this._volumeUp}\n                      ></ha-icon-button>\n                    `\n                  : \"\"}\n              </div>\n\n              <div class=\"controls\">${buttons}</div>\n            </div>\n          `\n        : \"\"}\n    `;\n  }\n\n  private async _attachObserver(): Promise<void> {\n    if (!this._resizeObserver) {\n      await installResizeObserver();\n      this._resizeObserver = new ResizeObserver(\n        debounce(() => this._measureCard(), 250, false)\n      );\n    }\n    this._resizeObserver.observe(this);\n  }\n\n  private _measureCard() {\n    if (!this.isConnected) {\n      return;\n    }\n    this._narrow = (this.clientWidth || 0) < 300;\n    this._veryNarrow = (this.clientWidth || 0) < 225;\n  }\n\n  private _computeControlButton(stateObj: HassEntity): ControlButton {\n    return stateObj.state === \"on\"\n      ? { icon: mdiPlayPause, action: \"media_play_pause\" }\n      : stateObj.state !== \"playing\"\n      ? { icon: mdiPlay, action: \"media_play\" }\n      : supportsFeature(stateObj, SUPPORT_PAUSE)\n      ? { icon: mdiPause, action: \"media_pause\" }\n      : { icon: mdiStop, action: \"media_stop\" };\n  }\n\n  private _togglePower(): void {\n    const stateObj = this.hass!.states[this._config!.entity];\n\n    this.hass!.callService(\n      \"media_player\",\n      stateObj.state === \"off\" ? \"turn_on\" : \"turn_off\",\n      {\n        entity_id: this._config!.entity,\n      }\n    );\n  }\n\n  private _playPauseStop(): void {\n    const stateObj = this.hass!.states[this._config!.entity];\n\n    const service =\n      stateObj.state !== \"playing\"\n        ? \"media_play\"\n        : supportsFeature(stateObj, SUPPORT_PAUSE)\n        ? \"media_pause\"\n        : \"media_stop\";\n\n    this.hass!.callService(\"media_player\", service, {\n      entity_id: this._config!.entity,\n    });\n  }\n\n  private _play(): void {\n    this.hass!.callService(\"media_player\", \"media_play\", {\n      entity_id: this._config!.entity,\n    });\n  }\n\n  private _pause(): void {\n    this.hass!.callService(\"media_player\", \"media_pause\", {\n      entity_id: this._config!.entity,\n    });\n  }\n\n  private _stop(): void {\n    this.hass!.callService(\"media_player\", \"media_stop\", {\n      entity_id: this._config!.entity,\n    });\n  }\n\n  private _previousTrack(): void {\n    this.hass!.callService(\"media_player\", \"media_previous_track\", {\n      entity_id: this._config!.entity,\n    });\n  }\n\n  private _nextTrack(): void {\n    this.hass!.callService(\"media_player\", \"media_next_track\", {\n      entity_id: this._config!.entity,\n    });\n  }\n\n  private _toggleMute() {\n    this.hass!.callService(\"media_player\", \"volume_mute\", {\n      entity_id: this._config!.entity,\n      is_volume_muted:\n        !this.hass!.states[this._config!.entity].attributes.is_volume_muted,\n    });\n  }\n\n  private _volumeDown() {\n    this.hass!.callService(\"media_player\", \"volume_down\", {\n      entity_id: this._config!.entity,\n    });\n  }\n\n  private _volumeUp() {\n    this.hass!.callService(\"media_player\", \"volume_up\", {\n      entity_id: this._config!.entity,\n    });\n  }\n\n  private _selectedValueChanged(ev): void {\n    this.hass!.callService(\"media_player\", \"volume_set\", {\n      entity_id: this._config!.entity,\n      volume_level: ev.target.value / 100,\n    });\n  }\n\n  static get styles(): CSSResultGroup {\n    return css`\n      :host {\n        display: block;\n      }\n      .flex {\n        display: flex;\n        align-items: center;\n        justify-content: space-between;\n      }\n      .volume {\n        display: flex;\n        flex-grow: 2;\n        flex-shrink: 2;\n      }\n      .controls {\n        white-space: nowrap;\n        direction: ltr;\n      }\n      ha-slider {\n        flex-grow: 2;\n        flex-shrink: 2;\n        width: 100%;\n        margin: 0 -8px 0 1px;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-media-player-entity-row\": HuiMediaPlayerEntityRow;\n  }\n}\n","import \"@material/mwc-button/mwc-button\";\nimport {\n  css,\n  CSSResultGroup,\n  html,\n  LitElement,\n  PropertyValues,\n  TemplateResult,\n} from \"lit\";\nimport { customElement, property, state } from \"lit/decorators\";\nimport \"../../../components/entity/ha-entity-toggle\";\nimport { UNAVAILABLE } from \"../../../data/entity\";\nimport { activateScene } from \"../../../data/scene\";\nimport { HomeAssistant } from \"../../../types\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\nimport \"../components/hui-generic-entity-row\";\nimport { createEntityNotFoundWarning } from \"../components/hui-warning\";\nimport { ActionRowConfig, LovelaceRow } from \"./types\";\n\n@customElement(\"hui-scene-entity-row\")\nclass HuiSceneEntityRow extends LitElement implements LovelaceRow {\n  @property({ attribute: false }) public hass!: HomeAssistant;\n\n  @state() private _config?: ActionRowConfig;\n\n  public setConfig(config: ActionRowConfig): void {\n    if (!config) {\n      throw new Error(\"Invalid configuration\");\n    }\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning>\n          ${createEntityNotFoundWarning(this.hass, this._config.entity)}\n        </hui-warning>\n      `;\n    }\n\n    return html`\n      <hui-generic-entity-row .hass=${this.hass} .config=${this._config}>\n        <mwc-button\n          @click=${this._callService}\n          .disabled=${stateObj.state === UNAVAILABLE}\n          class=\"text-content\"\n        >\n          ${this._config.action_name ||\n          this.hass!.localize(\"ui.card.scene.activate\")}\n        </mwc-button>\n      </hui-generic-entity-row>\n    `;\n  }\n\n  static get styles(): CSSResultGroup {\n    return css`\n      mwc-button {\n        margin-right: -0.57em;\n      }\n      :host {\n        cursor: pointer;\n      }\n    `;\n  }\n\n  private _callService(ev: Event): void {\n    ev.stopPropagation();\n    activateScene(this.hass, this._config!.entity);\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-scene-entity-row\": HuiSceneEntityRow;\n  }\n}\n","import \"@material/mwc-button/mwc-button\";\nimport {\n  css,\n  CSSResultGroup,\n  html,\n  LitElement,\n  PropertyValues,\n  TemplateResult,\n} from \"lit\";\nimport { customElement, property, state } from \"lit/decorators\";\nimport { UNAVAILABLE_STATES } from \"../../../data/entity\";\nimport { canRun, ScriptEntity } from \"../../../data/script\";\nimport { HomeAssistant } from \"../../../types\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\nimport \"../components/hui-generic-entity-row\";\nimport { createEntityNotFoundWarning } from \"../components/hui-warning\";\nimport { ActionRowConfig, LovelaceRow } from \"./types\";\n\n@customElement(\"hui-script-entity-row\")\nclass HuiScriptEntityRow extends LitElement implements LovelaceRow {\n  @property({ attribute: false }) public hass?: HomeAssistant;\n\n  @state() private _config?: ActionRowConfig;\n\n  public setConfig(config: ActionRowConfig): void {\n    if (!config) {\n      throw new Error(\"Invalid configuration\");\n    }\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity] as ScriptEntity;\n\n    if (!stateObj) {\n      return html`\n        <hui-warning>\n          ${createEntityNotFoundWarning(this.hass, this._config.entity)}\n        </hui-warning>\n      `;\n    }\n\n    return html`\n      <hui-generic-entity-row .hass=${this.hass} .config=${this._config}>\n        ${stateObj.state === \"on\"\n          ? html`<mwc-button @click=${this._cancelScript}>\n              ${stateObj.attributes.mode !== \"single\" &&\n              (stateObj.attributes.current || 0) > 0\n                ? this.hass.localize(\n                    \"ui.card.script.cancel_multiple\",\n                    \"number\",\n                    stateObj.attributes.current\n                  )\n                : this.hass.localize(\"ui.card.script.cancel\")}\n            </mwc-button>`\n          : \"\"}\n        ${stateObj.state === \"off\" || stateObj.attributes.max\n          ? html`<mwc-button\n              @click=${this._runScript}\n              .disabled=${UNAVAILABLE_STATES.includes(stateObj.state) ||\n              !canRun(stateObj)}\n            >\n              ${this._config.action_name ||\n              this.hass!.localize(\"ui.card.script.run\")}\n            </mwc-button>`\n          : \"\"}\n      </hui-generic-entity-row>\n    `;\n  }\n\n  static get styles(): CSSResultGroup {\n    return css`\n      mwc-button:last-child {\n        margin-right: -0.57em;\n      }\n    `;\n  }\n\n  private _cancelScript(ev): void {\n    ev.stopPropagation();\n    this._callService(\"turn_off\");\n  }\n\n  private _runScript(ev): void {\n    ev.stopPropagation();\n    this._callService(\"turn_on\");\n  }\n\n  private _callService(service: string): void {\n    this.hass!.callService(\"script\", service, {\n      entity_id: this._config!.entity,\n    });\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-script-entity-row\": HuiScriptEntityRow;\n  }\n}\n","import {\n  css,\n  CSSResultGroup,\n  html,\n  LitElement,\n  PropertyValues,\n  TemplateResult,\n} from \"lit\";\nimport { customElement, property, state } from \"lit/decorators\";\nimport { computeStateDisplay } from \"../../../common/entity/compute_state_display\";\nimport { UNAVAILABLE_STATES } from \"../../../data/entity\";\nimport { ActionHandlerEvent } from \"../../../data/lovelace\";\nimport { SENSOR_DEVICE_CLASS_TIMESTAMP } from \"../../../data/sensor\";\nimport { HomeAssistant } from \"../../../types\";\nimport { EntitiesCardEntityConfig } from \"../cards/types\";\nimport { actionHandler } from \"../common/directives/action-handler-directive\";\nimport { handleAction } from \"../common/handle-action\";\nimport { hasAction } from \"../common/has-action\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\nimport \"../components/hui-generic-entity-row\";\nimport \"../components/hui-timestamp-display\";\nimport { createEntityNotFoundWarning } from \"../components/hui-warning\";\nimport { TimestampRenderingFormat } from \"../components/types\";\nimport { LovelaceRow } from \"./types\";\n\ninterface SensorEntityConfig extends EntitiesCardEntityConfig {\n  format?: TimestampRenderingFormat;\n}\n\n@customElement(\"hui-sensor-entity-row\")\nclass HuiSensorEntityRow extends LitElement implements LovelaceRow {\n  @property({ attribute: false }) public hass?: HomeAssistant;\n\n  @state() private _config?: SensorEntityConfig;\n\n  public setConfig(config: SensorEntityConfig): void {\n    if (!config) {\n      throw new Error(\"Invalid configuration\");\n    }\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning>\n          ${createEntityNotFoundWarning(this.hass, this._config.entity)}\n        </hui-warning>\n      `;\n    }\n\n    return html`\n      <hui-generic-entity-row .hass=${this.hass} .config=${this._config}>\n        <div\n          class=\"text-content value\"\n          @action=${this._handleAction}\n          .actionHandler=${actionHandler({\n            hasHold: hasAction(this._config.hold_action),\n            hasDoubleClick: hasAction(this._config.double_tap_action),\n          })}\n        >\n          ${stateObj.attributes.device_class ===\n            SENSOR_DEVICE_CLASS_TIMESTAMP &&\n          !UNAVAILABLE_STATES.includes(stateObj.state)\n            ? html`\n                <hui-timestamp-display\n                  .hass=${this.hass}\n                  .ts=${new Date(stateObj.state)}\n                  .format=${this._config.format}\n                  capitalize\n                ></hui-timestamp-display>\n              `\n            : computeStateDisplay(\n                this.hass!.localize,\n                stateObj,\n                this.hass.locale\n              )}\n        </div>\n      </hui-generic-entity-row>\n    `;\n  }\n\n  private _handleAction(ev: ActionHandlerEvent) {\n    handleAction(this, this.hass!, this._config!, ev.detail.action);\n  }\n\n  static get styles(): CSSResultGroup {\n    return css`\n      div {\n        text-align: right;\n      }\n      .value {\n        direction: ltr;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-sensor-entity-row\": HuiSensorEntityRow;\n  }\n}\n","import {\n  css,\n  CSSResultGroup,\n  html,\n  LitElement,\n  PropertyValues,\n  TemplateResult,\n} from \"lit\";\nimport { customElement, property, state } from \"lit/decorators\";\nimport { computeStateDisplay } from \"../../../common/entity/compute_state_display\";\nimport { HomeAssistant } from \"../../../types\";\nimport { EntitiesCardEntityConfig } from \"../cards/types\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\nimport \"../components/hui-generic-entity-row\";\nimport { createEntityNotFoundWarning } from \"../components/hui-warning\";\nimport { LovelaceRow } from \"./types\";\n\n@customElement(\"hui-text-entity-row\")\nclass HuiTextEntityRow extends LitElement implements LovelaceRow {\n  @property({ attribute: false }) public hass?: HomeAssistant;\n\n  @state() private _config?: EntitiesCardEntityConfig;\n\n  public setConfig(config: EntitiesCardEntityConfig): void {\n    if (!config) {\n      throw new Error(\"Invalid configuration\");\n    }\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning>\n          ${createEntityNotFoundWarning(this.hass, this._config.entity)}\n        </hui-warning>\n      `;\n    }\n\n    return html`\n      <hui-generic-entity-row .hass=${this.hass} .config=${this._config}>\n        ${computeStateDisplay(this.hass!.localize, stateObj, this.hass.locale)}\n      </hui-generic-entity-row>\n    `;\n  }\n\n  static get styles(): CSSResultGroup {\n    return css`\n      div {\n        text-align: right;\n      }\n      .pointer {\n        cursor: pointer;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-text-entity-row\": HuiTextEntityRow;\n  }\n}\n","import { html, LitElement, PropertyValues, TemplateResult } from \"lit\";\nimport { customElement, property, state } from \"lit/decorators\";\nimport { computeStateDisplay } from \"../../../common/entity/compute_state_display\";\nimport \"../../../components/entity/ha-entity-toggle\";\nimport { UNAVAILABLE_STATES } from \"../../../data/entity\";\nimport { HomeAssistant } from \"../../../types\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\nimport \"../components/hui-generic-entity-row\";\nimport { createEntityNotFoundWarning } from \"../components/hui-warning\";\nimport { EntityConfig, LovelaceRow } from \"./types\";\n\n@customElement(\"hui-toggle-entity-row\")\nclass HuiToggleEntityRow extends LitElement implements LovelaceRow {\n  @property({ attribute: false }) public hass?: HomeAssistant;\n\n  @state() private _config?: EntityConfig;\n\n  public setConfig(config: EntityConfig): void {\n    if (!config) {\n      throw new Error(\"Invalid configuration\");\n    }\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning>\n          ${createEntityNotFoundWarning(this.hass, this._config.entity)}\n        </hui-warning>\n      `;\n    }\n\n    const showToggle =\n      stateObj.state === \"on\" ||\n      stateObj.state === \"off\" ||\n      UNAVAILABLE_STATES.includes(stateObj.state);\n\n    return html`\n      <hui-generic-entity-row\n        .hass=${this.hass}\n        .config=${this._config}\n        .catchInteraction=${!showToggle}\n      >\n        ${showToggle\n          ? html`\n              <ha-entity-toggle\n                .hass=${this.hass}\n                .stateObj=${stateObj}\n              ></ha-entity-toggle>\n            `\n          : html`\n              <div class=\"text-content\">\n                ${computeStateDisplay(\n                  this.hass!.localize,\n                  stateObj,\n                  this.hass!.locale\n                )}\n              </div>\n            `}\n      </hui-generic-entity-row>\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-toggle-entity-row\": HuiToggleEntityRow;\n  }\n}\n","import {\n  css,\n  CSSResultGroup,\n  html,\n  LitElement,\n  PropertyValues,\n  TemplateResult,\n} from \"lit\";\nimport { customElement, property, state } from \"lit/decorators\";\nimport checkValidDate from \"../../../common/datetime/check_valid_date\";\nimport { formatNumber } from \"../../../common/number/format_number\";\nimport { formatAttributeValue } from \"../../../data/entity_attributes\";\nimport { HomeAssistant } from \"../../../types\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\nimport \"../components/hui-generic-entity-row\";\nimport \"../components/hui-timestamp-display\";\nimport { createEntityNotFoundWarning } from \"../components/hui-warning\";\nimport { AttributeRowConfig, LovelaceRow } from \"../entity-rows/types\";\n\n@customElement(\"hui-attribute-row\")\nclass HuiAttributeRow extends LitElement implements LovelaceRow {\n  @property({ attribute: false }) public hass?: HomeAssistant;\n\n  @state() private _config?: AttributeRowConfig;\n\n  public setConfig(config: AttributeRowConfig): void {\n    if (!config) {\n      throw new Error(\"Invalid configuration\");\n    }\n    if (!config.entity) {\n      throw new Error(\"Entity not specified\");\n    }\n    if (!config.attribute) {\n      throw new Error(\"Attribute not specified\");\n    }\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning>\n          ${createEntityNotFoundWarning(this.hass, this._config.entity)}\n        </hui-warning>\n      `;\n    }\n\n    const attribute = stateObj.attributes[this._config.attribute];\n    let date: Date | undefined;\n    if (this._config.format) {\n      date = new Date(attribute);\n    }\n\n    return html`\n      <hui-generic-entity-row .hass=${this.hass} .config=${this._config}>\n        ${this._config.prefix}\n        ${this._config.format && checkValidDate(date)\n          ? html` <hui-timestamp-display\n              .hass=${this.hass}\n              .ts=${date}\n              .format=${this._config.format}\n              capitalize\n            ></hui-timestamp-display>`\n          : typeof attribute === \"number\"\n          ? formatNumber(attribute, this.hass.locale)\n          : attribute !== undefined\n          ? formatAttributeValue(this.hass, attribute)\n          : \"—\"}\n        ${this._config.suffix}\n      </hui-generic-entity-row>\n    `;\n  }\n\n  static get styles(): CSSResultGroup {\n    return css`\n      div {\n        text-align: right;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-attribute-row\": HuiAttributeRow;\n  }\n}\n","import \"@material/mwc-button\";\nimport { css, CSSResultGroup, html, LitElement, TemplateResult } from \"lit\";\nimport { customElement, state } from \"lit/decorators\";\nimport { DOMAINS_TOGGLE } from \"../../../common/const\";\nimport { computeDomain } from \"../../../common/entity/compute_domain\";\nimport { computeStateName } from \"../../../common/entity/compute_state_name\";\nimport { ActionHandlerEvent } from \"../../../data/lovelace\";\nimport { HomeAssistant } from \"../../../types\";\nimport { actionHandler } from \"../common/directives/action-handler-directive\";\nimport { handleAction } from \"../common/handle-action\";\nimport { hasAction } from \"../common/has-action\";\nimport { ButtonRowConfig, LovelaceRow } from \"../entity-rows/types\";\nimport \"../../../components/ha-state-icon\";\n\n@customElement(\"hui-button-row\")\nexport class HuiButtonRow extends LitElement implements LovelaceRow {\n  public hass?: HomeAssistant;\n\n  @state() private _config?: ButtonRowConfig;\n\n  public setConfig(config: ButtonRowConfig): void {\n    if (!config) {\n      throw new Error(\"Invalid configuration\");\n    }\n\n    if (!config.name && !config.entity) {\n      throw new Error(\"No name and no entity specified\");\n    }\n\n    this._config = {\n      tap_action: {\n        action:\n          config.entity && DOMAINS_TOGGLE.has(computeDomain(config.entity))\n            ? \"toggle\"\n            : \"more-info\",\n      },\n      hold_action: { action: \"more-info\" },\n      ...config,\n    };\n  }\n\n  protected render(): TemplateResult {\n    if (!this._config) {\n      return html``;\n    }\n\n    const stateObj =\n      this._config.entity && this.hass\n        ? this.hass.states[this._config.entity]\n        : undefined;\n\n    const name =\n      this._config.name ?? (stateObj ? computeStateName(stateObj) : \"\");\n\n    return html`\n      <ha-state-icon .icon=${this._config.icon} .state=${stateObj}>\n      </ha-state-icon>\n      <div class=\"flex\">\n        <div .title=${name}>${name}</div>\n        <mwc-button\n          @action=${this._handleAction}\n          .actionHandler=${actionHandler({\n            hasHold: hasAction(this._config!.hold_action),\n            hasDoubleClick: hasAction(this._config!.double_tap_action),\n          })}\n          >${this._config.action_name\n            ? this._config.action_name\n            : this.hass!.localize(\"ui.card.service.run\")}</mwc-button\n        >\n      </div>\n    `;\n  }\n\n  static get styles(): CSSResultGroup {\n    return css`\n      :host {\n        display: flex;\n        align-items: center;\n      }\n      ha-state-icon {\n        padding: 8px;\n        color: var(--paper-item-icon-color);\n      }\n      .flex {\n        flex: 1;\n        overflow: hidden;\n        margin-left: 16px;\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n      }\n      .flex div {\n        white-space: nowrap;\n        overflow: hidden;\n        text-overflow: ellipsis;\n      }\n      mwc-button {\n        margin-right: -0.57em;\n      }\n    `;\n  }\n\n  private _handleAction(ev: ActionHandlerEvent) {\n    handleAction(this, this.hass!, this._config!, ev.detail.action!);\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-button-row\": HuiButtonRow;\n  }\n}\n"],"names":[],"sourceRoot":""}