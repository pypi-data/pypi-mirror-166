"use strict";(self.webpackChunkpiperider_report=self.webpackChunkpiperider_report||[]).push([[65],{1065:function(e,n,t){t.r(n),t.d(n,{default:function(){return E}});var s=t(1413),i=t(2982),r=t(885),l=t(5223),a=t(8735),o=t(6837),d=t(8625),c=t(2791),u=t(3853),h=t(8062),x=t(6157),v=t(2483),j=t(5987),m=t(8540),p=t(2504),f=t(7005),g=t(5558),b=t(5484),T=t(184);function C(e){var n,t,s,i,r,l,a=e.data;return(0,T.jsx)(f.xJ,{children:(0,T.jsxs)(f.iA,{variant:"simple",children:[(0,T.jsx)(f.hr,{children:(0,T.jsxs)(f.Tr,{children:[(0,T.jsx)(f.Th,{}),(0,T.jsx)(f.Th,{children:"Status"}),(0,T.jsx)(f.Th,{children:"Message"})]})}),(0,T.jsxs)(f.p3,{children:[(0,T.jsxs)(f.Tr,{children:[(0,T.jsx)(f.Td,{fontWeight:700,children:"Base"}),(0,T.jsx)(f.Td,{children:(0,T.jsx)(b.s,{status:null===a||void 0===a||null===(n=a.base)||void 0===n?void 0:n.status})}),(0,T.jsx)(f.Td,{children:null!==(t=null===a||void 0===a||null===(s=a.base)||void 0===s?void 0:s.message)&&void 0!==t?t:g.Nj})]}),(0,T.jsxs)(f.Tr,{children:[(0,T.jsx)(f.Td,{fontWeight:700,children:"Target"}),(0,T.jsx)(f.Td,{children:(0,T.jsx)(b.s,{status:null===a||void 0===a||null===(i=a.target)||void 0===i?void 0:i.status})}),(0,T.jsx)(f.Td,{children:null!==(r=null===a||void 0===a||null===(l=a.base)||void 0===l?void 0:l.message)&&void 0!==r?r:g.Nj})]})]})]})})}var S=t(709);function k(e){var n,t,s,i,r,l,a=e.data;return(0,T.jsx)(f.xJ,{children:(0,T.jsxs)(f.iA,{variant:"simple",children:[(0,T.jsx)(f.hr,{children:(0,T.jsxs)(f.Tr,{children:[(0,T.jsx)(f.Th,{}),(0,T.jsx)(f.Th,{children:"Status"}),(0,T.jsx)(f.Th,{children:"Expected"}),(0,T.jsx)(f.Th,{children:"Actual"})]})}),(0,T.jsxs)(f.p3,{children:[(0,T.jsxs)(f.Tr,{children:[(0,T.jsx)(f.Td,{fontWeight:700,children:"Base"}),(0,T.jsx)(f.Td,{children:(0,T.jsx)(b.s,{status:null===a||void 0===a||null===(n=a.base)||void 0===n?void 0:n.status})}),(0,T.jsx)(f.Td,{children:(0,S.sG)(null===a||void 0===a||null===(t=a.base)||void 0===t?void 0:t.expected)}),(0,T.jsx)(f.Td,{children:(0,S.sG)(null===a||void 0===a||null===(s=a.base)||void 0===s?void 0:s.actual)})]}),(0,T.jsxs)(f.Tr,{children:[(0,T.jsx)(f.Td,{fontWeight:700,children:"Target"}),(0,T.jsx)(f.Td,{children:(0,T.jsx)(b.s,{status:null===a||void 0===a||null===(i=a.target)||void 0===i?void 0:i.status})}),(0,T.jsx)(f.Td,{children:(0,S.sG)(null===a||void 0===a||null===(r=a.target)||void 0===r?void 0:r.expected)}),(0,T.jsx)(f.Td,{children:(0,S.sG)(null===a||void 0===a||null===(l=a.target)||void 0===l?void 0:l.actual)})]})]})]})})}var y=["data","type","isOpen","onClose"];function Z(e){var n=e.data,t=e.type,i=void 0===t?"piperider":t,r=e.isOpen,l=e.onClose,o=(0,j.Z)(e,y);return(0,T.jsxs)(m.u_,(0,s.Z)((0,s.Z)({},o),{},{isOpen:r,size:"2xl",onClose:function(){l()},children:[(0,T.jsx)(m.ZA,{}),(0,T.jsxs)(m.hz,{children:[(0,T.jsx)(m.xB,{children:(0,T.jsx)(a.xv,{title:null===n||void 0===n?void 0:n.name,noOfLines:1,maxWidth:"calc(100% - 50px)",children:null===n||void 0===n?void 0:n.name})}),(0,T.jsx)(m.ol,{}),(0,T.jsx)(m.fe,{children:"piperider"===i?(0,T.jsx)(k,{data:n}):(0,T.jsx)(C,{data:n})}),(0,T.jsx)(m.mz,{children:(0,T.jsx)(p.zx,{onClick:l,children:"Close"})})]})]}))}var D=t(6523),w=t(1241),V=t(429),A=t(4323),P=t(5827),O=t(2740),$=["baseColumnDatum","targetColumnDatum"];function z(e){var n=e.baseColumnDatum,t=e.targetColumnDatum,i=(0,j.Z)(e,$);(0,D.h5)(D.a$.safeParse(n)),(0,D.h5)(D.a$.safeParse(t));var r=(0,V.Kn)([["total","Total"]],n,t,"count"),l=(0,V.Kn)([["valids","Valid"],["invalids","Invalid"],["nulls","Missing"]],n,t);return(0,T.jsxs)(T.Fragment,{children:[r.map((function(e,n){var t=e.firstSlot,r=e.secondSlot,l=e.metakey,a=e.name,o=e.tooltipValues;return(0,T.jsx)(O.$,(0,s.Z)({name:a,metakey:l,firstSlot:t,secondSlot:r,tooltipValues:o,width:"100%"},i),n)})),l.map((function(e,n){var t=e.firstSlot,r=e.secondSlot,l=e.metakey,a=e.name,o=e.tooltipValues;return(0,T.jsx)(O.$,(0,s.Z)({name:a,metakey:l,firstSlot:t,secondSlot:r,tooltipValues:o,width:"100%"},i),n)}))]})}var I=["baseColumnDatum","targetColumnDatum"];function N(e){var n=e.baseColumnDatum,t=e.targetColumnDatum,i=(0,j.Z)(e,I);(0,D.h5)(D.a$.safeParse(n));var r="string"===(null===n||void 0===n?void 0:n.type)?" (".concat(g.d4,")"):"",l=(0,V.Kn)([["avg","Average"],["stddev","SD"]],n,t,"count"),o=(0,V.Kn)([["min","Min"],["max","Max"]],n,t,"count"),d=(0,V.Kn)([["distinct","Distincts"],["duplicates","Duplicates"]],n,t);return(0,T.jsxs)(T.Fragment,{children:[((0,V.Yb)(null===n||void 0===n?void 0:n.type)||(0,V.Yb)(null===t||void 0===t?void 0:t.type))&&(0,T.jsx)(a.kC,{direction:"column",children:l&&l.map((function(e,n){var t=e.name,l=e.metakey,a=e.firstSlot,o=e.secondSlot,d=e.tooltipValues;return(0,T.jsx)(O.$,(0,s.Z)({name:t,subtitle:r,metakey:l,firstSlot:a,secondSlot:o,tooltipValues:d,width:"100%"},i),n)}))}),((0,V.lZ)(null===n||void 0===n?void 0:n.type)||(0,V.lZ)(null===t||void 0===t?void 0:t.type))&&(0,T.jsx)(a.kC,{direction:"column",children:o&&o.map((function(e,n){var t=e.name,l=e.metakey,a=e.firstSlot,o=e.secondSlot,d=e.tooltipValues;return(0,T.jsx)(O.$,(0,s.Z)({name:t,subtitle:r,metakey:l,firstSlot:a,secondSlot:o,tooltipValues:d,width:"100%"},i),n)}))}),((0,V.aO)(null===n||void 0===n?void 0:n.type)||(0,V.aO)(null===t||void 0===t?void 0:t.type))&&(0,T.jsx)(a.kC,{direction:"column",mt:3,children:d&&d.map((function(e,n){var t=e.name,r=e.metakey,l=e.firstSlot,a=e.secondSlot,o=e.tooltipValues;return(0,T.jsx)(O.$,(0,s.Z)({name:t,metakey:r,firstSlot:l,secondSlot:a,tooltipValues:o,width:"100%"},i),n)}))})]})}var H=function(e){var n,t,s,i,l=e.baseColumn,o=e.targetColumn,c=l||o,u=(0,V.JH)(l),h=(0,d.TH)(),x=(0,r.Z)(h,1)[0];return(0,D.h5)(D.a$.safeParse(l)),(0,D.h5)(D.a$.safeParse(o)),(0,T.jsxs)(a.kC,{direction:"column",minH:"250px",border:"1px solid darkgray",rounded:"2xl",children:[c&&(0,T.jsx)(P.u,{columnDatum:c,bg:"blue.800",color:"white"}),(0,T.jsxs)(a.xu,{m:4,children:[(0,T.jsx)(O.$,{name:"",firstSlot:"Base",secondSlot:"Target",width:"100%",fontWeight:"bold",mb:3}),(0,T.jsx)(a.xu,{mb:3,children:(0,T.jsx)(z,{baseColumnDatum:l,targetColumnDatum:o})}),(0,T.jsx)(a.xu,{mb:3,children:(0,T.jsx)(N,{baseColumnDatum:l,targetColumnDatum:o})}),u&&(0,T.jsx)(a.xu,{children:(0,T.jsx)(O.$,{name:"Most Common",metakey:"topk",width:"100%",firstSlot:null!==(n=null===l||void 0===l||null===(t=l.topk)||void 0===t?void 0:t.values[0])&&void 0!==n?n:g.Nj,secondSlot:null!==(s=null===o||void 0===o||null===(i=o.topk)||void 0===i?void 0:i.values[0])&&void 0!==s?s:g.Nj})})]}),c&&(0,T.jsx)(a.kC,{justifyContent:"center",p:3,h:"100%",alignItems:"end",children:(0,T.jsx)(d.rU,{href:"".concat(x,"/columns/").concat(c.name),children:(0,T.jsx)(a.xv,{as:"a",color:"blue.400",children:"Details"})})})]})};function _(e){var n=e.baseTable,t=e.targetTable;(0,D.h5)(D.vT.safeParse(n)),(0,D.h5)(D.vT.safeParse(t));var s=(0,V.WN)(null===n||void 0===n?void 0:n.columns,null===t||void 0===t?void 0:t.columns);return(0,T.jsx)(T.Fragment,{children:Object.entries(s).map((function(e){var n=(0,r.Z)(e,2),t=n[0],s=n[1];return(0,T.jsx)(J,{name:t,base:null===s||void 0===s?void 0:s.base,target:null===s||void 0===s?void 0:s.target},t)}))})}function J(e){var n=e.name,t=e.base,s=e.target;return(0,T.jsx)(a.kC,{direction:"column",children:(0,T.jsxs)(a.rj,{my:8,templateColumns:"1fr 2fr",gap:12,overflowX:"hidden",children:[(0,T.jsx)(H,{baseColumn:t,targetColumn:s}),(0,T.jsxs)(a.kC,{my:4,alignItems:"center",children:[(0,T.jsx)(A.T,{height:350,children:(0,w.S)(t)}),(0,T.jsx)(A.T,{height:350,children:(0,w.S)(s,t)})]})]})},n)}var R=t(9113);function W(e){var n=e.baseTable,t=e.targetTable;return(0,D.h5)(D.vT.safeParse(n)),(0,D.h5)(D.vT.safeParse(t)),(0,T.jsxs)(a.kC,{gap:1,direction:"column",mb:8,children:[(0,T.jsx)(a.xv,{color:"gray.500",children:"Table"}),(0,T.jsx)(a.X6,{fontSize:24,children:(0,T.jsxs)(a.kC,{alignItems:"center",children:[(0,T.jsx)(R.JO,{as:u.aCJ,mr:1}),null===t||void 0===t?void 0:t.name]})}),(0,T.jsx)(a.xv,{fontSize:"sm",children:null===t||void 0===t?void 0:t.description})]})}var G=t(6646),M=t(8444),B=t.n(M),K=t(5984),F=["assertions"];function X(e){return Object.values(e).map((function(e){var n={name:e[0].name};return e.forEach((function(e){"base"===e.from?n.base=e:n.target=e})),n}))}function U(e){var n=e.assertions,t=(0,j.Z)(e,F),s=n.piperider,r=n.dbt,l=B()(s,(function(e){return"".concat(e.level,"_").concat(e.column,"_").concat(e.name)})),o=B()(r,(function(e){return"".concat(e.level,"_").concat(e.column,"_").concat(e.name)})),d=X(l),c=X(o),u=function(e,n){var t=e.reduce((function(e,n){return Y("PipeRider",n,e)}),{passed:[],failed:[]}),s=t.passed,r=t.failed,l=n.reduce((function(e,n){return Y("dbt",n,e)}),{passed:[],failed:[]}),a=l.passed,o=l.failed;return{passedAssertionRows:[].concat((0,i.Z)(s),(0,i.Z)(a)),failedAssertionRows:[].concat((0,i.Z)(r),(0,i.Z)(o))}}(d,c),h=u.passedAssertionRows,x=u.failedAssertionRows;return 0===d.length&&0===c.length?(0,T.jsx)(a.kC,{direction:"column",justifyContent:"center",alignItems:"center",children:(0,T.jsx)(a.xv,{textAlign:"center",children:"No tests available"})}):(0,T.jsx)(f.xJ,{children:(0,T.jsxs)(f.iA,{variant:"simple",children:[(0,T.jsx)(f.hr,{children:(0,T.jsxs)(f.Tr,{children:[(0,T.jsx)(f.Th,{children:"Assertion"}),(0,T.jsx)(f.Th,{children:"Base Status"}),(0,T.jsx)(f.Th,{children:"Target Status"}),(0,T.jsx)(f.Th,{children:"Source"}),(0,T.jsx)(f.Th,{})]})}),(0,T.jsxs)(f.p3,{children:[x.map((function(e){var n,s;return(0,T.jsxs)(f.Tr,{children:[(0,T.jsx)(f.Td,{children:e.name}),(0,T.jsx)(f.Td,{children:(0,T.jsx)(b.s,{status:null===(n=e.base)||void 0===n?void 0:n.status})}),(0,T.jsx)(f.Td,{children:(0,T.jsx)(b.s,{status:null===(s=e.target)||void 0===s?void 0:s.status})}),(0,T.jsx)(f.Td,{children:e.source}),(0,T.jsx)(f.Td,{onClick:function(){t.onDetailVisible({type:"piperider",data:e})},children:(0,T.jsx)(a.xv,{as:"span",cursor:"pointer",children:"\ud83d\udd0d"})})]},(0,K.x0)())})),h.map((function(e){var n,s;return(0,T.jsxs)(f.Tr,{children:[(0,T.jsx)(f.Td,{children:e.name}),(0,T.jsx)(f.Td,{children:(0,T.jsx)(b.s,{status:null===(n=e.base)||void 0===n?void 0:n.status})}),(0,T.jsx)(f.Td,{children:(0,T.jsx)(b.s,{status:null===(s=e.target)||void 0===s?void 0:s.status})}),(0,T.jsx)(f.Td,{children:e.source}),(0,T.jsx)(f.Td,{onClick:function(){t.onDetailVisible({type:"piperider",data:e})},children:(0,T.jsx)(a.xv,{as:"span",cursor:"pointer",children:"\ud83d\udd0d"})})]},(0,K.x0)())}))]})]})})}function Y(e,n,t){var i,r;n&&("failed"===(null===(i=n.base)||void 0===i?void 0:i.status)||"failed"===(null===(r=n.target)||void 0===r?void 0:r.status)?t.failed.push((0,s.Z)((0,s.Z)({},n),{},{source:e})):t.passed.push((0,s.Z)((0,s.Z)({},n),{},{source:e})));return t}function E(e){var n=e.data,t=e.name,j=(0,c.useState)(null),m=(0,r.Z)(j,2),p=m[0],f=m[1],g=(0,l.qY)(),b=(0,c.useState)(!1),C=(0,r.Z)(b,2),k=C[0],y=C[1],w=(0,c.useState)(!1),V=(0,r.Z)(w,2),A=V[0],P=V[1],O=n.base,$=n.input;(0,D.h5)((0,D.C6)(!0).safeParse(n));var z=O.tables[t],I=$.tables[t];(0,D.h5)(D.vT.safeParse(z)),(0,D.h5)(D.vT.safeParse(I));var N=(0,x.Ix)({data:n,reportName:t,type:"piperider"}),H=(0,r.Z)(N,2),J=H[0],R=H[1],M=(0,x.Ix)({data:n,reportName:t,type:"dbt"}),B=(0,r.Z)(M,2),K=B[0],F=B[1],X=[].concat((0,i.Z)((null===J||void 0===J?void 0:J.tests)||[]),(0,i.Z)((null===R||void 0===R?void 0:R.tests)||[])),Y=[].concat((0,i.Z)((null===K||void 0===K?void 0:K.tests)||[]),(0,i.Z)((null===F||void 0===F?void 0:F.tests)||[])),E=0===X.length&&0===Y.length;return(0,v.j)(t),(0,T.jsxs)(h.o,{isSingleReport:!1,time:"".concat((0,S.D8)(O.created_at)," -> ").concat((0,S.D8)($.created_at)),children:[(0,T.jsxs)(a.kC,{direction:"column",width:"inherit",children:[(0,T.jsx)(a.kC,{mx:"5%",mt:4,children:(0,T.jsxs)(o.aG,{fontSize:"lg",children:[(0,T.jsx)(o.gN,{children:(0,T.jsx)(d.rU,{href:"/",children:(0,T.jsx)(o.At,{href:"/","data-cy":"cr-report-breadcrumb-back",children:(0,T.jsxs)(a.kC,{alignItems:"center",gap:1,children:[(0,T.jsx)(u.bGz,{})," Tables"]})})})}),(0,T.jsx)(o.gN,{isCurrentPage:!0,children:(0,T.jsx)(o.At,{href:"#",children:(0,T.jsxs)(a.kC,{alignItems:"center",gap:1,children:[(0,T.jsx)(u.aCJ,{}),t]})})})]})}),(0,T.jsxs)(a.kC,{border:"1px solid",borderColor:"gray.300",bg:"white",borderRadius:"md",p:6,mt:3,mx:"5%",direction:"column",children:[(0,T.jsx)(W,{baseTable:z,targetTable:I}),(0,T.jsx)(a.X6,{size:"md",children:"Assertions"}),(0,T.jsx)(G.S,{in:k,startingHeight:E?50:250,collapseable:!E,onVisible:function(){return y((function(e){return!e}))},children:(0,T.jsx)(U,{assertions:{piperider:X,dbt:Y},onDetailVisible:function(e){var n=e.data,t=e.type;f({type:t,data:n}),g.onOpen()}})}),(0,T.jsx)(a.X6,{size:"md",mt:4,children:"Columns"}),(0,T.jsx)(G.S,{in:A,startingHeight:void 0===z&&void 0===I?50:350,collapseable:void 0!==z||void 0!==I,onVisible:function(){return P((function(e){return!e}))},children:(0,T.jsx)(_,{baseTable:z,targetTable:I})})]})]}),(0,T.jsx)(Z,(0,s.Z)((0,s.Z)({},g),{},{type:null===p||void 0===p?void 0:p.type,data:null===p||void 0===p?void 0:p.data,onClose:function(){g.onClose(),f(null)}}))]})}},5484:function(e,n,t){t.d(n,{s:function(){return r}});var s=t(8735),i=t(184);function r(e){switch(e.status){case"passed":return(0,i.jsx)(s.xv,{as:"span",role:"img",children:"\u2705"});case"failed":return(0,i.jsx)(s.xv,{as:"span",role:"img",children:"\u274c"});default:return(0,i.jsx)(s.xv,{as:"span",role:"img",children:"-"})}}},6646:function(e,n,t){t.d(n,{S:function(){return c}});var s=t(5987),i=t(7231),r=t(8735),l=t(9113),a=t(3853),o=t(184),d=["children","startingHeight","collapseable","onVisible"];function c(e){var n=e.children,t=e.startingHeight,c=void 0===t?250:t,u=e.collapseable,h=void 0===u||u,x=e.onVisible,v=(0,s.Z)(e,d);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(i.UO,{startingHeight:c,in:v.in,children:n}),h&&(0,o.jsxs)(r.kC,{as:"button",justifyContent:"center",alignItems:"center",color:"piperider.500",mt:4,height:8,onClick:function(){x()},children:[(0,o.jsx)(r.xv,{as:"span",children:v.in?"Less":"More"}),(0,o.jsx)(l.JO,{as:a.rH8,boxSize:6,transform:v.in?"rotate(0deg)":"rotate(180deg)",transition:"transform 0.2s ease-in"})]})]})}}}]);
//# sourceMappingURL=65.164e6753.chunk.js.map