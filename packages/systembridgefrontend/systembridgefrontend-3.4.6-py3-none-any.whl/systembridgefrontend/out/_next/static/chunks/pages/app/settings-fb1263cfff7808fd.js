(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[877],{4768:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/app/settings",function(){return n(92)}])},311:function(e,t,n){"use strict";n.d(t,{Z:function(){return S}});var i=n(6042),r=n(9396),s=n(5893),o=n(7294),a=n(1163),c=n(9008),l=n.n(c),d=n(562),u=n(8849),p=n(3648),h=n(2971),x=n(2097),f=n(5050),g=n(6336),m=n(784),y=n(9072),v=n(5084),j=n(9630),Z=n(1953);function b(e){var t=e.children,n=(0,h.Z)({disableHysteresis:!0,threshold:24});return(0,o.cloneElement)(t,{elevation:n?4:0})}var k=function(){var e=(0,o.useState)(!1),t=e[0],n=e[1],i=((0,o.useCallback)((function(){n(!t)}),[t]),(0,x.Z)());return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(b,{children:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(f.Z,{color:"transparent",elevation:0,children:(0,s.jsx)(g.Z,{maxWidth:"xl",sx:{padding:0},children:(0,s.jsx)(m.Z,{sx:{minHeight:50,maxHeight:50,padding:0,flex:1,alignItems:"center",justifyContent:"space-between",display:"flex",flexWrap:"nowrap"},children:(0,s.jsx)(y.ZP,{item:!0,children:(0,s.jsx)(v.Z,{href:"https://system-bridge.timmo.dev",target:"_blank",children:(0,s.jsx)(j.Z,{component:"div",variant:"h4",sx:{textTransform:"none",userSelect:"none",color:i.palette.primary.contrastText},children:"System Bridge"})})})})})}),(0,s.jsx)(Z.Z,{sx:{height:i.spacing(18)}})]})})})},w=!1;var S=function(e){var t=(0,a.useRouter)();return(0,o.useEffect)((function(){if(t.isReady&&!w){var e,n,s,o;w=!0;var a=(null===(e=t.query)||void 0===e?void 0:e.apiKey)||"",c=(null===(n=t.query)||void 0===n?void 0:n.apiPort)||"9170",l=!1;if((null===(s=t.query)||void 0===s?void 0:s.apiKey)||(l=!0,a=window.prompt("Please enter your API key",a)),(null===(o=t.query)||void 0===o?void 0:o.apiPort)||(l=!0,c=window.prompt("Please enter your API port (default: 9170)",c)),l&&a&&c){var d=t.asPath.split("?")[0];t.replace({pathname:d.includes(".html")?d:"".concat(d,".html"),query:(0,r.Z)((0,i.Z)({},t.query),{apiKey:a,apiPort:c})})}}}),[t]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(l(),{children:[(0,s.jsx)("title",{children:e.title?"".concat(e.title," - System Bridge"):"System Bridge"}),(0,s.jsx)("link",{rel:"canonical",href:e.url}),(0,s.jsx)("meta",{name:"description",content:e.description?"".concat(e.description):e.title?"".concat(e.title," - System Bridge"):"System Bridge"}),(0,s.jsx)("meta",{name:"keywords",content:e.keywords?"".concat(e.keywords):"system-bridge, system, bridge, typescript"})]}),!e.noHeader&&(0,s.jsx)(k,{}),e.closeButton&&(0,s.jsx)(d.Z,{size:"small",sx:{position:"absolute",top:4,right:4,zIndex:1e3},onClick:function(){window.location.href="http://close.window"},children:(0,s.jsx)(u.Icon,{id:"close",path:p.r5M,size:1})}),e.children]})}},8768:function(e,t,n){"use strict";n.d(t,{D:function(){return s},X:function(){return r}});var i=n(7294);function r(e){navigator.permissions.query({name:"clipboard-write"}).then((function(t){"granted"!==t.state&&"prompt"!==t.state||navigator.clipboard.writeText(e)}))}function s(e){var t=(0,i.useRef)();return(0,i.useEffect)((function(){t.current=e})),t.current}},8838:function(e,t,n){"use strict";n.d(t,{C:function(){return a}});var i=n(7568),r=n(1438),s=n(4051),o=n.n(s),a=function(){function e(t,n,s){(0,r.Z)(this,e),this.port=t||9170,this.apiKey=n;var a=this;(0,i.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.connect();case 2:a.websocket=e.sent,s&&a.websocket&&a.websocket.readyState===a.websocket.OPEN&&s();case 4:case"end":return e.stop()}}),e)})))()}var t=e.prototype;return t.close=function(){this.websocket&&this.websocket.readyState===this.websocket.OPEN&&this.websocket.close()},t.connect=function(){var e=this;return(0,i.Z)(o().mark((function t(){var n;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new WebSocket("ws://".concat(window.location.hostname||"localhost",":").concat(e.port,"/api/websocket")),t.next=3,new Promise((function(e){n.onopen=function(){return e()}}));case 3:return n.onmessage=function(t){if("string"===typeof t.data){var n=JSON.parse(t.data);n&&e.onEvent&&e.onEvent(n)}},t.abrupt("return",n);case 5:case"end":return t.stop()}}),t)})))()},t.isConnected=function(){var e;return(null===(e=this.websocket)||void 0===e?void 0:e.readyState)===WebSocket.OPEN},t.getData=function(e){this.websocket&&this.websocket.readyState===this.websocket.OPEN&&(console.log("Get data:",e),this.websocket.send(JSON.stringify({"api-key":this.apiKey,event:"GET_DATA",modules:e})))},t.getSettings=function(){this.websocket&&this.websocket.readyState===this.websocket.OPEN&&(console.log("Get settings"),this.websocket.send(JSON.stringify({"api-key":this.apiKey,event:"GET_SETTINGS"})))},t.registerDataListener=function(e){this.websocket&&this.websocket.readyState===this.websocket.OPEN&&(console.log("Register data listener:",e),this.websocket.send(JSON.stringify({"api-key":this.apiKey,event:"REGISTER_DATA_LISTENER",modules:e})))},t.sendPlayerStatus=function(e){this.websocket&&this.websocket.readyState===this.websocket.OPEN&&this.websocket.send(JSON.stringify({"api-key":this.apiKey,event:"MEDIA_STATUS",status:e}))},t.updateSetting=function(e,t){this.websocket&&this.websocket.readyState===this.websocket.OPEN&&(console.log("Update setting:",{key:e,value:t}),this.websocket.send(JSON.stringify({"api-key":this.apiKey,event:"UPDATE_SETTING",setting:e,value:t})))},e}()},92:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return ee}});var i=n(5893),r=n(7294),s=n(6336),o=n(311),a=n(7568),c=n(4924),l=n(6042),d=n(9396),u=n(603),p=n(4051),h=n.n(p),x=n(2097),f=n(9072),g=n(754),m=n(1163),y=n(3648),v=n(1946),j=n(8838),Z=n(5934),b=n(5309),k=n(8746),w=n(9901),S=n(4548),P=n(7825),C=n(5118),E=n(5343),I=n(9063),N=n(9041),A=n(562),_=n(1520),O=n(8769),T=n(8849),R=n(8768),D=n(1225),z=n(1890),W=n(7745),G=n(4642),K=n(5398),q=n(5214),L=n(6779),F=n(5084),B=n(6486),U=n.n(B);var J=function(e){var t=e.setting,n=e.listIn,s=e.open,o=e.setOpen,a=e.handleChanged,c=(0,r.useState)([]),l=c[0],d=c[1],u=t.name,p=t.description,h=t.icon;(0,r.useEffect)((function(){!s&&n&&d(n)}),[n,s]);var g=(0,x.Z)(),m=(0,D.Z)(g.breakpoints.down("md"));return(0,i.jsxs)(z.Z,{fullScreen:m,fullWidth:!0,maxWidth:"lg",open:s,scroll:"paper",PaperProps:{style:{background:g.palette.background.paper}},children:[(0,i.jsxs)(W.Z,{children:[(0,i.jsx)(T.Icon,{id:"copy-to-clipboard",title:"Copy to clipboard",size:.7,path:h,style:{marginRight:g.spacing(1)}}),u]}),(0,i.jsx)(G.Z,{sx:{margin:g.spacing(0,3)},children:p}),(0,i.jsx)(K.Z,{children:(0,i.jsxs)(q.Z,{children:[l.map((function(e,t){return(0,i.jsx)(k.ZP,{children:(0,i.jsxs)(f.ZP,{container:!0,alignItems:"center",children:[(0,i.jsx)(f.ZP,{item:!0,xs:4,sx:{marginRight:g.spacing(1)},children:(0,i.jsx)(O.Z,{id:"name",label:"Name",fullWidth:!0,variant:"outlined",value:e.name,onChange:function(e){var n=U().cloneDeep(l);console.log("Update name:",t,n,n[t]),n&&n[t]&&(n[t].name=e.target.value,d(n))}})}),(0,i.jsx)(f.ZP,{item:!0,xs:!0,sx:{marginLeft:g.spacing(1)},children:(0,i.jsx)(O.Z,{id:"value",label:"Value",fullWidth:!0,variant:"outlined",value:e.value,onChange:function(e){var n=U().cloneDeep(l);console.log("Update value:",t,n,n[t]),n&&n[t]&&(n[t].value=e.target.value,d(n))}})}),(0,i.jsx)(f.ZP,{item:!0,children:(0,i.jsx)(A.Z,{"aria-label":"Remove",size:"large",onClick:function(){var e=U().cloneDeep(l);e.splice(t,1),d(e)},children:(0,i.jsx)(T.Icon,{id:"remove-item",title:"Remove",size:.8,path:y.S6N})})})]})},t)})),(0,i.jsxs)(b.Z,{onClick:function(){var e=U().cloneDeep(l);e.push({name:"",value:""}),d(e)},children:[(0,i.jsx)(w.Z,{children:(0,i.jsx)(T.Icon,{id:"add",title:"Add",size:1,path:y.qX5})}),(0,i.jsx)(S.Z,{primary:"Add",secondary:"Add a new item"})]})]})}),(0,i.jsxs)(L.Z,{children:[(0,i.jsx)(F.Z,{onClick:function(){o(!1)},color:"primary",variant:"outlined",children:"Cancel"}),(0,i.jsx)(F.Z,{onClick:function(){o(!1),a(l.sort((function(e,t){return e.name.localeCompare(t.name)})))},color:"primary",variant:"outlined",children:"Save"})]})]})};var M=function(e){var t=e.keyIn,n=e.valueIn,s=e.handleChanged,o=function(e){D(e)},a=function(e){o(e.target.value)},c=(0,r.useState)(!1),u=c[0],p=c[1],h=(0,r.useState)(!1),g=h[0],m=h[1],v=(0,r.useState)(n),j=v[0],D=v[1],z=(0,r.useMemo)((function(){return n!==j}),[n,j]),W=Y[t],G=W.name,K=W.description,q=W.icon,L=W.containerDisabled,F=W.isList,B=W.isPassword,U=W.minimum,M=(0,x.Z)(),V=function(e){var t=e.children;return F?(0,i.jsx)(b.Z,{onClick:function(){return p(!0)},children:t}):(0,i.jsx)(k.ZP,{children:t})};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(V,{children:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(w.Z,{children:(0,i.jsx)(T.Icon,{id:"icon",title:G,size:1,path:q})}),(0,i.jsx)(S.Z,{primary:G,secondary:K,sx:{maxWidth:"64%",userSelect:"none"}}),(0,i.jsx)(P.Z,{sx:{width:420,textAlign:"end"},children:(0,i.jsxs)(f.ZP,{container:!0,alignItems:"center",justifyContent:"flex-end",children:[(0,i.jsx)(f.ZP,{item:!0,children:"boolean"===typeof j?(0,i.jsx)(C.Z,{edge:"end",disabled:L,checked:j,onChange:function(e,t){o(t)}}):"string"===typeof n&&"api_key"===t?(0,i.jsx)(E.Z,{fullWidth:!0,variant:"outlined",children:(0,i.jsx)(I.Z,{type:"text",disabled:!0,value:j,endAdornment:(0,i.jsxs)(N.Z,{position:"end",children:[(0,i.jsx)(A.Z,{"aria-label":"Generate Api Key",onClick:function(){o((0,Z.Z)())},edge:"end",size:"large",sx:{margin:M.spacing(-1,-.5)},children:(0,i.jsx)(T.Icon,{id:"generate-api-key",title:"Generate API Key",size:1,path:y.VmU})}),(0,i.jsx)(A.Z,{"aria-label":"Copy to clipboard",onClick:function(){return(0,R.X)(String(j))},size:"large",sx:{margin:M.spacing(-1,-.5)},children:(0,i.jsx)(T.Icon,{id:"copy-to-clipboard",title:"Copy to clipboard",size:.8,path:y.a0Z})})]})})}):"string"===typeof n&&"string"===typeof j&&"log_level"===t?(0,i.jsx)(_.Z,{id:t,options:["DEBUG","INFO","WARNING","ERROR","CRITICAL"],renderInput:function(e){return(0,i.jsx)(O.Z,(0,d.Z)((0,l.Z)({},e),{variant:"outlined"}))},onChange:function(e,t){t&&o(t)},sx:{width:210},value:j}):"string"===typeof n&&B?(0,i.jsx)(E.Z,{variant:"outlined",children:(0,i.jsx)(I.Z,{type:g?"text":"password",defaultValue:j,onChange:a,endAdornment:(0,i.jsx)(N.Z,{position:"end",children:(0,i.jsx)(A.Z,{"aria-label":"Toggle visibility",onClick:function(){m(!g)},onMouseDown:function(e){e.preventDefault()},size:"large",children:(0,i.jsx)(T.Icon,{id:"copy-to-clipboard",title:"Copy to clipboard",size:.8,path:g?y.rgx:y.DqW})})})})}):"string"===typeof n?(0,i.jsx)(O.Z,{type:"text",defaultValue:j,disabled:L,onChange:a,variant:"outlined"}):"number"===typeof n?(0,i.jsx)(O.Z,{error:!!U&&Number(j)<U,type:"number",disabled:L,inputProps:{minimum:U},defaultValue:j,onChange:a,variant:"outlined"}):""}),F?"":(0,i.jsx)(f.ZP,{item:!0,children:(0,i.jsx)(A.Z,{disabled:!1===z,onClick:function(){s(t,j)},sx:{margin:M.spacing(1)},children:(0,i.jsx)(T.Icon,{id:"save",title:"Save",size:1,path:y.JTj,style:{opacity:z?1:.25}})})})]})})]})}),F&&Array.isArray(j)?(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(J,{setting:Y[t],listIn:j,open:u,setOpen:p,handleChanged:function(e){D(e),s(t,e)}})}):""]})},V=n(9630),X=n(918);var H,Q=function(e){var t=e.name,n=e.description,r=e.children;return(0,i.jsxs)(f.ZP,{container:!0,direction:"row",item:!0,xs:12,children:[(0,i.jsxs)(f.ZP,{item:!0,xs:4,style:{userSelect:"none"},children:[(0,i.jsx)(V.Z,{component:"h3",variant:"h5",children:t}),(0,i.jsx)(V.Z,{variant:"subtitle1",children:n})]}),(0,i.jsx)(f.ZP,{item:!0,xs:8,children:(0,i.jsx)(X.Z,{children:(0,i.jsx)(q.Z,{children:r})})})]})},Y={autostart:{name:"Autostart",description:"Automatically start the application on startup",icon:y.USr},log_level:{name:"Log Level",description:"Log level for the application",icon:y.eLz},port_api:{name:"API Port",description:"Port for the API and WebSocket",icon:y.A0p},additional_media_directories:{name:"Additional Media Directories",description:"Additional media directories for the media endpoint",icon:y.Rmq,isList:!0}};var $=function(){var e=(0,u.Z)((0,v.r)(),2),t=e[0],n=e[1],s=(0,r.useState)(!1),o=s[0],p=s[1],y=(0,m.useRouter)().query,Z=(0,r.useCallback)((function(e){if(console.log("Event:",e),"SETTINGS_RESULT"===e.type){console.log("Settings result data:",e.data);var t={};console.log("settingsMap:",Y);var i=Object.keys(Y);e.data.sort((function(e,t){return i.indexOf(e.key)>i.indexOf(t.key)?1:-1})).forEach((function(e){t[e.key]=e.value})),console.log("Settings:",t),n(t)}}),[n]),b=(0,r.useCallback)((function(e,t){console.log("Setup WebSocketConnection"),(H=new j.C(e,t,(0,a.Z)(h().mark((function e(){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:H.getSettings();case 1:case"end":return e.stop()}}),e)}))))).onEvent=Z}),[Z]),k=(0,r.useCallback)((function(e,i){H.updateSetting(e,i),n((0,d.Z)((0,l.Z)({},t),(0,c.Z)({},e,i)))}),[t,n]);(0,r.useEffect)((function(){!o&&y&&y.apiKey&&(p(!0),b(Number(y.apiPort)||9170,String(y.apiKey)))}),[o,b,y]);var w=(0,x.Z)();return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(f.ZP,{container:!0,direction:"column",spacing:2,alignItems:"stretch",sx:{marginBottom:w.spacing(8),padding:w.spacing(2)},children:t?(0,i.jsx)(Q,{name:"General",description:"General settings",children:(0,i.jsx)(i.Fragment,{children:Object.keys(t).map((function(e,n){return(0,i.jsx)(M,{keyIn:e,valueIn:t[e],handleChanged:k},n)}))})}):(0,i.jsx)(f.ZP,{container:!0,direction:"row",justifyContent:"center",sx:{margin:w.spacing(2,0,10)},children:(0,i.jsx)(g.Z,{})})})})};var ee=function(){return(0,i.jsx)(o.Z,{title:"Settings",url:"https://system-bridge.timmo.dev",description:"Frontend for System Bridge",children:(0,i.jsx)(s.Z,{component:"article",maxWidth:"xl",children:(0,i.jsx)($,{})})})}}},function(e){e.O(0,[702,662,127,913,598,769,520,93,77,774,888,179],(function(){return t=4768,e(e.s=t);var t}));var t=e.O();_N_E=t}]);