[metadata]
name = target-s3-jsonl
version = attr: target_s3_jsonl.__version__
description = Singer.io target for writing JSON Line files and upload to S3
long_description = file: README.md
long_description_content_type = text/markdown
author = Eddy âˆ†
author_email = edrdelta@gmail.com
url = https://github.com/ome9ax/target-s3-jsonl
keywords = target-s3-jsonl, target-s3-json, singer, singer.io, tap, target, etl, json, jsonl, aws, s3
license = Apache License 2.0
classifiers = 
	Development Status :: 5 - Production/Stable
	Operating System :: OS Independent
	License :: OSI Approved :: Apache Software License
	Programming Language :: Python :: 3.8
	Programming Language :: Python :: 3.9
	Programming Language :: Python :: 3.10
project_urls = 
	Releases = https://github.com/ome9ax/target-s3-jsonl/releases
	Changelog = https://github.com/ome9ax/target-s3-jsonl/blob/main/CHANGELOG.rst
	Issue Tracker = https://github.com/ome9ax/target-s3-jsonl/issues

[options]
packages = find:
package_dir = 
	= src
python_requires = >=3.8
include_package_data = True
platforms = any

[options.entry_points]
console_scripts = 
	target-s3-jsonl = target_s3_jsonl:main

[options.package_data]
target_s3_jsonl = logging.conf

[options.packages.find]
where = src
exclude = 
	tests

[options.extras_require]
test = 
	pytest-cov
	moto[s3,sts]
lint = flake8
static = mypy
dist = build
deploy = twine

[tool:pytest]
addopts = -v --cov=target_s3_jsonl --cov-fail-under 95 --cov-report annotate --cov-report xml --cov-report term --cov-report html:htmlcov --doctest-modules
testpaths = tests
asyncio_mode = auto

[coverage:run]
branch = True
omit = 
	./setup.py
	tests/.*
	venv/*

[coverage:report]
show_missing = True
skip_covered = False
exclude_lines = 
	if __name__ == .__main__.:

[flake8]
count = True
show-source = True
statistics = True
extend-exclude = venv
	build
ignore = C901
max-line-length = 160
max-complexity = 10

[build_sphinx]
builder = html
warning-is-error = true
project = 'Target S3 Jsonl'
version = attr: target_s3_jsonl.__version__
release = attr: target_s3_jsonl.__version__
source-dir = 'docs'

[tox:tox]
passenv = TOXENV TOX_* CI_* GITLAB_*
envlist = py{38,39,310}
isolated_build = True

[testenv]
usedevelop = True
extras = test
commands = pytest {posargs}

[testenv:lint]
usedevelop = True
skip_install = true
deps = flake8
commands = flake8 {posargs}

[testenv:static]
usedevelop = True
skip_install = true
deps = mypy
commands = mypy {posargs}

[testenv:coverage]
usedevelop = True
passenv = CODECOV_TOKEN CI_*
skip_install = true
deps = codecov
commands = 
	codecov \
	--file "{toxinidir}/coverage.xml" \
	--name "codecov-$CI_PROJECT_NAME" \
	--branch "$CI_COMMIT_BRANCH" \
	--commit "$CI_COMMIT_SHA" \
	--tag "$CI_COMMIT_TAG" \
	--flags "unittests" {posargs} || echo 'Codecov upload failed'

[testenv:docs]
description = Invoke sphinx-build to build the HTML docs
usedevelop = True
extras = docs
commands = sphinx-build docs/source "{toxworkdir}/docs_out" -d "{toxworkdir}/docs_doctree" -W -j auto --color -b html {posargs}
commands_post = python -c 'import pathlib; print("documentation available under file://\{0\}".format(pathlib.Path(r"{toxworkdir}") / "docs_out" / "index.html"))'

[testenv:dist]
deps = build
commands = python -m build

[testenv:deploy]
usedevelop = True
skip_install = true
passenv = TWINE_*
deps = 
	build
	twine
commands_pre = 
	python -m build
	twine check dist/*
commands = twine upload --skip-existing {posargs} dist/*

[egg_info]
tag_build = 
tag_date = 0

