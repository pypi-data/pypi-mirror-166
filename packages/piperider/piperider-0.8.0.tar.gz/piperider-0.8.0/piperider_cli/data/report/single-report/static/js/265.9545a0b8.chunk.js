"use strict";(self.webpackChunkpiperider_report=self.webpackChunkpiperider_report||[]).push([[265],{9265:function(e,n,s){s.r(n),s.d(n,{default:function(){return X}});var r=s(885),t=s(8735),i=s(6837),a=s(8625),l=s(3853),c=s(2791),u=s(8062),o=s(6646),d=s(2483),m=s(6523),x=s(1241),j=s(429),h=s(184),v=function(e){var n=e.children;return(0,h.jsx)(t.kC,{p:2,bg:"white",height:"100%",direction:"column",borderBottomRadius:"inherit",children:n})},p=s(4323),f=s(5827),b=s(709),g=s(2220),y=s(5272),k=s(9934),C=function(e){var n=e.label,s=e.value,r=e.subvalue,i=e.metaKey,a="string"===typeof i?k.d[i]:null;return(0,h.jsxs)(t.kC,{direction:"column",w:"100%",mx:2,my:2,children:[(0,h.jsx)(g.u,{label:a,isDisabled:!Boolean(a),placement:"top",children:(0,h.jsxs)(t.kC,{alignItems:"center",w:"fit-content",children:[(0,h.jsx)(t.xv,{lineHeight:"5",fontSize:"small",children:n}),(0,h.jsx)(y.sz,{color:"gray.400",boxSize:"12px",ml:2})]})}),(0,h.jsx)(t.xv,{fontWeight:"bold",children:s}),r&&(0,h.jsx)(t.xv,{fontSize:"smaller",children:r})]})},z=s(5558);function D(e){var n=e.columnDatum,s=e.children,r=n.nulls,i=n.invalids,a=(0,j.Jk)("invalids",n),l=(0,j.Jk)("nulls",n);return(0,h.jsxs)(t.kC,{direction:"column",children:[(0,h.jsx)(t.xv,{textAlign:"center",fontWeight:"bold",my:2,children:"Data Composition"}),(0,h.jsx)(t.iz,{}),(0,h.jsxs)(t.kC,{justify:"space-evenly",children:[(0,h.jsx)(C,{metaKey:"nulls",label:z.td,value:(0,b.uy)(l,b.Zn),subvalue:r}),(0,h.jsx)(t.iz,{orientation:"vertical"}),(0,h.jsx)(C,{metaKey:"invalids",label:z.ST,value:(0,b.uy)(a,b.Zn),subvalue:i}),s]})]})}var _=function(e){var n=e.columnDatum,s=n.trues,r=n.falses;return(0,h.jsxs)(t.kC,{direction:"column",children:[(0,h.jsxs)(D,{columnDatum:n,children:[(0,h.jsx)(t.iz,{orientation:"vertical"}),(0,h.jsx)(C,{label:z.aJ,value:(0,b.uy)(r,b.uf),metaKey:"falses"}),(0,h.jsx)(t.iz,{orientation:"vertical"}),(0,h.jsx)(C,{label:z.Y0,value:(0,b.uy)(s,b.uf),metaKey:"trues"})]}),(0,h.jsx)(t.iz,{})]})};function T(e){var n=e.columnDatum,s=n.distinct,r=n.duplicates,i=(0,j.Jk)("distinct",n),a=(0,j.Jk)("duplicates",n);return(0,h.jsxs)(t.kC,{direction:"column",children:[(0,h.jsx)(t.xv,{textAlign:"center",fontWeight:"bold",my:2,children:"Uniqueness"}),(0,h.jsx)(t.iz,{}),(0,h.jsxs)(t.kC,{justify:"space-evenly",children:[(0,h.jsx)(C,{metaKey:"distinct",label:z.A$,value:(0,b.uy)(i,b.Zn),subvalue:s}),(0,h.jsx)(t.iz,{orientation:"vertical"}),(0,h.jsx)(C,{metaKey:"duplicates",label:z.hD,value:(0,b.uy)(a,b.Zn),subvalue:r})]})]})}var Z=function(e){var n=e.columnDatum,s=n.valids,r=(0,b.Th)(n),i=r.topValues,a=r.topCounts,l=(0,j.Jk)("valids",n);return(0,h.jsxs)(t.kC,{direction:"column",children:[(0,h.jsxs)(D,{columnDatum:n,children:[(0,h.jsx)(t.iz,{orientation:"vertical"}),(0,h.jsx)(C,{metaKey:"valids",label:z.Px,value:(0,b.uy)(l,b.Zn),subvalue:s})]}),(0,h.jsx)(t.iz,{}),(0,h.jsx)(T,{columnDatum:n}),(0,h.jsx)(t.iz,{}),i&&a&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(C,{metaKey:"topk",label:z.IK,value:i,subvalue:a}),(0,h.jsx)(t.iz,{})]})]})};function S(e){var n=e.columnDatum,s=n.avg,r=n.stddev,i=n.min,a=n.max,l="string"===n.type,c=(0,j.JH)(n),u=l&&!c?"Length":"Data";return(0,h.jsxs)(t.kC,{direction:"column",children:[(0,h.jsxs)(t.xv,{textAlign:"center",fontWeight:"bold",my:2,children:[u," Statistics"]}),(0,h.jsx)(t.iz,{}),s&&(0,h.jsxs)(t.kC,{justify:"space-evenly",children:[(0,h.jsx)(C,{metaKey:"avg",label:z.dc,value:(0,b.uy)(s,b.uf)}),(0,h.jsx)(t.iz,{orientation:"vertical"}),(0,h.jsx)(C,{metaKey:"stddev",label:z.lb,value:z.o6+(0,b.uy)(r,b.uf)}),(0,h.jsx)(t.iz,{orientation:"vertical"})]}),(0,h.jsx)(t.iz,{}),(0,h.jsxs)(t.kC,{justify:"space-evenly",children:[(0,h.jsx)(C,{metaKey:"min",label:z.KX,value:(0,b.uy)(i,b.uf)}),(0,h.jsx)(t.iz,{orientation:"vertical"}),(0,h.jsx)(C,{metaKey:"max",label:z.k2,value:(0,b.uy)(a,b.uf)})]})]})}var K=function(e){var n=e.columnDatum;return(0,h.jsxs)(t.kC,{direction:"column",children:[(0,h.jsx)(D,{columnDatum:n}),(0,h.jsx)(t.iz,{}),(0,h.jsx)(T,{columnDatum:n}),(0,h.jsx)(t.iz,{}),(0,h.jsx)(S,{columnDatum:n})]})},N=s(3634),A=function(e){var n=e.columnDatum,s=n.negatives,r=n.zeros,i=(0,j.Jk)("negatives",n),a=(0,j.Jk)("zeros",n);return(0,h.jsxs)(t.kC,{direction:"column",children:[(0,h.jsxs)(D,{columnDatum:n,children:[(0,h.jsx)(t.iz,{orientation:"vertical"}),(0,h.jsx)(C,{metaKey:"negatives",label:z.wC,value:(0,b.uy)(i,b.Zn),subvalue:s}),(0,h.jsx)(t.iz,{orientation:"vertical"}),(0,h.jsx)(C,{metaKey:"zeros",label:z.AG,value:(0,b.uy)(a,b.Zn),subvalue:r})]}),(0,h.jsx)(t.iz,{}),(0,h.jsx)(t.iz,{}),(0,h.jsx)(S,{columnDatum:n}),(0,h.jsx)(t.iz,{}),(0,h.jsx)(t.kC,{mt:2,children:(0,h.jsx)(N.d,{columnDatum:n})})]})},J=function(e){var n=e.columnDatum,s=n.valids,r=(0,j.Jk)("valids",n);return(0,h.jsxs)(t.kC,{direction:"column",children:[(0,h.jsxs)(D,{columnDatum:n,children:[(0,h.jsx)(t.iz,{orientation:"vertical"}),(0,h.jsx)(C,{metaKey:"valids",label:z.Px,value:(0,b.uy)(r,b.Zn),subvalue:s})]}),(0,h.jsx)(t.iz,{})]})},w=function(e){var n=e.columnDatum,s=n.zero_length,r=(0,j.Jk)("zero_length",n);return(0,h.jsxs)(t.kC,{direction:"column",children:[(0,h.jsxs)(D,{columnDatum:n,children:[(0,h.jsx)(t.iz,{orientation:"vertical"}),(0,h.jsx)(C,{metaKey:"zero_length",label:z.cU,value:(0,b.uy)(r,b.Zn),subvalue:s})]}),(0,h.jsx)(t.iz,{}),(0,h.jsx)(T,{columnDatum:n}),(0,h.jsx)(t.iz,{}),(0,h.jsx)(S,{columnDatum:n}),(0,h.jsx)(t.iz,{}),(0,h.jsx)(t.kC,{justify:"space-evenly"})]})};function O(e){var n=e.columnDatum;m.a$.parse(n);var s=n.name,i=(0,a.TH)(),l=(0,r.Z)(i,1)[0];return(0,h.jsxs)(t.kC,{direction:"column",bg:"gray.300",width:{xl:"32%",lg:"45%",md:"100%",base:"100%"},border:"1px solid",borderColor:"gray.300",my:3,rounded:"lg",children:[(0,h.jsx)(f.u,{columnDatum:n,bg:"blue.800",color:"white"}),(0,h.jsx)(p.T,{title:s,allowModalPopup:Boolean((0,j.W9)(n)),children:(0,x.S)(n)}),(0,h.jsx)(v,{children:(0,h.jsxs)(h.Fragment,{children:[P(n),(0,h.jsx)(t.kC,{justifyContent:"center",py:2,h:"100%",alignItems:"end",children:(0,h.jsx)(a.rU,{href:"".concat(l,"/columns/").concat(s),children:(0,h.jsx)(t.xv,{as:"a",color:"blue.400","data-cy":"column-card-details-link",children:"Details"})})})]})})]})}function P(e){var n=e.type,s=(0,j.JH)(e);return"string"!==n&&"integer"!==n||!s?"numeric"===n||"integer"===n?(0,h.jsx)(A,{columnDatum:e}):"boolean"===n?(0,h.jsx)(_,{columnDatum:e}):"string"===n?(0,h.jsx)(w,{columnDatum:e}):"datetime"===n?(0,h.jsx)(K,{columnDatum:e}):"other"===n?(0,h.jsx)(J,{columnDatum:e}):(0,h.jsxs)(t.xv,{textAlign:"center",w:"inherit",children:["The column type: ",n," cannot be displayed"]}):(0,h.jsx)(Z,{columnDatum:e})}var E=s(5984);function G(e){var n=e.data;return(0,h.jsx)(t.kC,{direction:"row",flexWrap:"wrap",gap:4,children:Object.keys(n).map((function(e){var s=n[e];return(0,m.h5)(m.a$.safeParse(s)),(0,h.jsx)(O,{columnDatum:s},(0,E.x0)())}))})}var H=s(2982),I=s(1413),B=s(7005),$=s(5484);function R(e){var n=e.assertions,s=function(e,n){var s=((null===e||void 0===e?void 0:e.tests)||[]).reduce((function(e,n){return W("PipeRider",n,e)}),{passed:[],failed:[]}),r=s.passed,t=s.failed,i=Object.keys((null===e||void 0===e?void 0:e.columns)||{}).map((function(n){return((null===e||void 0===e?void 0:e.columns[n])||[]).map((function(e){return e}))})).flat().reduce((function(e,n){return W("PipeRider",n,e)}),{passed:[],failed:[]}),a=i.passed,l=i.failed,c=((null===n||void 0===n?void 0:n.tests)||[]).reduce((function(e,n){return W("dbt",n,e)}),{passed:[],failed:[]}),u=c.passed,o=c.failed,d=Object.keys((null===n||void 0===n?void 0:n.columns)||{}).map((function(e){return((null===n||void 0===n?void 0:n.columns[e])||[]).map((function(e){return e}))})).flat().reduce((function(e,n){return W("dbt",n,e)}),{passed:[],failed:[]}),m=d.passed,x=d.failed;return{passedAssertions:[].concat((0,H.Z)(r),(0,H.Z)(a),(0,H.Z)(u),(0,H.Z)(m)),failedAssertions:[].concat((0,H.Z)(t),(0,H.Z)(l),(0,H.Z)(o),(0,H.Z)(x))}}(null===n||void 0===n?void 0:n.piperider,null===n||void 0===n?void 0:n.dbt),r=s.passedAssertions,i=s.failedAssertions;return 0===r.length&&0===i.length?(0,h.jsx)(t.kC,{direction:"column",alignItems:"center",justifyContent:"center",children:(0,h.jsx)(t.xv,{textAlign:"center",children:"No tests available"})}):(0,h.jsx)(t.kC,{direction:"column",gap:4,children:(0,h.jsx)(B.xJ,{children:(0,h.jsxs)(B.iA,{variant:"simple",children:[(0,h.jsx)(B.hr,{children:(0,h.jsxs)(B.Tr,{children:[(0,h.jsx)(B.Th,{children:"Assertion"}),(0,h.jsx)(B.Th,{children:"Status"}),(0,h.jsx)(B.Th,{children:"Expected"}),(0,h.jsx)(B.Th,{children:"Actual"}),(0,h.jsx)(B.Th,{children:"Source"})]})}),(0,h.jsxs)(B.p3,{children:[i.map((function(e){return(0,h.jsxs)(B.Tr,{children:[(0,h.jsx)(B.Td,{children:e.name}),(0,h.jsx)(B.Td,{children:(0,h.jsx)($.s,{status:e.status})}),(0,h.jsx)(B.Td,{children:(0,b.sG)(e.expected)}),(0,h.jsx)(B.Td,{color:"red.500",children:(0,b.sG)(e.actual)}),(0,h.jsx)(B.Td,{children:e.source})]},e.name)})),r.map((function(e){return(0,h.jsxs)(B.Tr,{children:[(0,h.jsx)(B.Td,{children:e.name}),(0,h.jsx)(B.Td,{children:(0,h.jsx)($.s,{status:e.status})}),(0,h.jsx)(B.Td,{children:(0,b.sG)(e.expected)}),(0,h.jsx)(B.Td,{children:(0,b.sG)(e.actual)}),(0,h.jsx)(B.Td,{children:e.source})]},e.name)}))]})]})})})}function W(e,n,s){return"passed"===n.status?s.passed.push((0,I.Z)((0,I.Z)({},n),{},{source:e})):s.failed.push((0,I.Z)((0,I.Z)({},n),{},{source:e})),s}var L=s(9113);function U(e){var n=e.table;return(0,m.h5)(m.vT.safeParse(n)),(0,h.jsxs)(t.kC,{direction:"column",gap:1,mb:8,children:[(0,h.jsx)(t.xv,{color:"gray.500",children:"Table"}),(0,h.jsx)(t.X6,{fontSize:24,children:(0,h.jsxs)(t.kC,{alignItems:"center",children:[(0,h.jsx)(L.JO,{as:l.aCJ,mr:1}),n.name]})}),(0,h.jsx)(t.xv,{fontSize:"sm",children:n.description})]})}var V=s(4821);function X(e){var n,s,x,j,v=e.data,p=e.name,f=v.datasource,g=v.tables[p],y=(0,c.useState)(!1),k=(0,r.Z)(y,2),C=k[0],z=k[1],D=(0,c.useState)(!1),_=(0,r.Z)(D,2),T=_[0],Z=_[1],S=0===((null===(n=g.piperider_assertion_result)||void 0===n?void 0:n.tests)||[]).length&&0===Object.keys((null===(s=g.piperider_assertion_result)||void 0===s?void 0:s.columns)||{}).length&&0===((null===(x=g.dbt_assertion_result)||void 0===x?void 0:x.tests)||[]).length&&0===Object.keys((null===(j=g.dbt_assertion_result)||void 0===j?void 0:j.columns)||{}).length;return(0,m.h5)(m.vT.safeParse(g)),(0,m.h5)(V.U0.safeParse(f)),(0,d.j)(p),v?(0,h.jsx)(u.o,{isSingleReport:!0,time:(0,b.D8)(v.created_at),children:(0,h.jsxs)(t.kC,{direction:"column",width:"100%",children:[(0,h.jsx)(t.kC,{mx:"5%",mt:4,children:(0,h.jsxs)(i.aG,{fontSize:"lg",children:[(0,h.jsx)(i.gN,{children:(0,h.jsx)(a.rU,{href:"/",children:(0,h.jsx)(i.At,{href:"/","data-cy":"sr-report-breadcrumb-back",children:(0,h.jsxs)(t.kC,{alignItems:"center",gap:1,children:[(0,h.jsx)(l.bGz,{})," ",f.name]})})})}),(0,h.jsx)(i.gN,{isCurrentPage:!0,children:(0,h.jsx)(i.At,{href:"#",children:(0,h.jsxs)(t.kC,{alignItems:"center",gap:1,children:[(0,h.jsx)(l.aCJ,{})," ",g.name]})})})]})}),(0,h.jsxs)(t.kC,{border:"1px solid",borderColor:"gray.300",bg:"white",borderRadius:"md",p:6,mt:3,mx:"5%",direction:"column",gap:4,children:[(0,h.jsx)(U,{table:g}),(0,h.jsx)(t.X6,{size:"md",children:"Assertions"}),(0,h.jsx)(o.S,{in:C,startingHeight:S?50:250,collapseable:!S,onVisible:function(){return z((function(e){return!e}))},children:(0,h.jsx)(R,{assertions:{piperider:g.piperider_assertion_result,dbt:null===g||void 0===g?void 0:g.dbt_assertion_result}})}),(0,h.jsx)(t.X6,{size:"md",mt:4,children:"Columns"}),(0,h.jsx)(o.S,{in:T,startingHeight:0===Object.keys(g.columns).length?50:350,collapseable:Object.keys(g.columns).length>0,onVisible:function(){return Z((function(e){return!e}))},children:(0,h.jsx)(G,{data:g.columns})})]})]})}):(0,h.jsx)(u.o,{isSingleReport:!0,time:"-",children:(0,h.jsx)(t.kC,{justifyContent:"center",alignItems:"center",minHeight:"100vh",children:"No profile data found."})})}},5484:function(e,n,s){s.d(n,{s:function(){return i}});var r=s(8735),t=s(184);function i(e){switch(e.status){case"passed":return(0,t.jsx)(r.xv,{as:"span",role:"img",children:"\u2705"});case"failed":return(0,t.jsx)(r.xv,{as:"span",role:"img",children:"\u274c"});default:return(0,t.jsx)(r.xv,{as:"span",role:"img",children:"-"})}}},6646:function(e,n,s){s.d(n,{S:function(){return o}});var r=s(5987),t=s(7231),i=s(8735),a=s(9113),l=s(3853),c=s(184),u=["children","startingHeight","collapseable","onVisible"];function o(e){var n=e.children,s=e.startingHeight,o=void 0===s?250:s,d=e.collapseable,m=void 0===d||d,x=e.onVisible,j=(0,r.Z)(e,u);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(t.UO,{startingHeight:o,in:j.in,children:n}),m&&(0,c.jsxs)(i.kC,{as:"button",justifyContent:"center",alignItems:"center",color:"piperider.500",mt:4,height:8,onClick:function(){x()},children:[(0,c.jsx)(i.xv,{as:"span",children:j.in?"Less":"More"}),(0,c.jsx)(a.JO,{as:l.rH8,boxSize:6,transform:j.in?"rotate(0deg)":"rotate(180deg)",transition:"transform 0.2s ease-in"})]})]})}},6837:function(e,n,s){s.d(n,{At:function(){return p},aG:function(){return b},gN:function(){return f}});var r=s(1340),t=s(5971),i=s(9611),a=s(2791);function l(){return l=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r])}return e},l.apply(this,arguments)}function c(e,n){if(null==e)return{};var s,r,t={},i=Object.keys(e);for(r=0;r<i.length;r++)s=i[r],n.indexOf(s)>=0||(t[s]=e[s]);return t}var u=["spacing"],o=["isCurrentPage","as","className","href"],d=["isCurrentPage","separator","isLastChild","spacing","children","className"],m=["children","spacing","separator","className"],x=(0,r.eC)("Breadcrumb"),j=x[0],h=x[1],v=(0,r.Gp)((function(e,n){var s=e.spacing,t=c(e,u),i=l({mx:s},h().separator);return a.createElement(r.m$.span,l({ref:n,role:"presentation"},t,{__css:i}))}));t.Ts&&(v.displayName="BreadcrumbSeparator");var p=(0,r.Gp)((function(e,n){var s=e.isCurrentPage,i=e.as,u=e.className,d=e.href,m=c(e,o),x=h(),j=l({ref:n,as:i,className:(0,t.cx)("chakra-breadcrumb__link",u)},m);return s?a.createElement(r.m$.span,l({"aria-current":"page",__css:x.link},j)):a.createElement(r.m$.a,l({__css:x.link,href:d},j))}));t.Ts&&(p.displayName="BreadcrumbLink");var f=(0,r.Gp)((function(e,n){var s=e.isCurrentPage,u=e.separator,o=e.isLastChild,m=e.spacing,x=e.children,j=e.className,f=c(e,d),b=(0,i.WR)(x).map((function(e){return e.type===p?a.cloneElement(e,{isCurrentPage:s}):e.type===v?a.cloneElement(e,{spacing:m,children:e.props.children||u}):e})),g=l({display:"inline-flex",alignItems:"center"},h().item),y=(0,t.cx)("chakra-breadcrumb__list-item",j);return a.createElement(r.m$.li,l({ref:n,className:y},f,{__css:g}),b,!o&&a.createElement(v,{spacing:m},u))}));t.Ts&&(f.displayName="BreadcrumbItem");var b=(0,r.Gp)((function(e,n){var s=(0,r.jC)("Breadcrumb",e),u=(0,r.Lr)(e),o=u.children,d=u.spacing,x=void 0===d?"0.5rem":d,h=u.separator,v=void 0===h?"/":h,p=u.className,f=c(u,m),b=(0,i.WR)(o),g=b.length,y=b.map((function(e,n){return a.cloneElement(e,{separator:v,spacing:x,isLastChild:g===n+1})})),k=(0,t.cx)("chakra-breadcrumb",p);return a.createElement(r.m$.nav,l({ref:n,"aria-label":"breadcrumb",className:k,__css:s.container},f),a.createElement(j,{value:s},a.createElement(r.m$.ol,{className:"chakra-breadcrumb__list"},y)))}));t.Ts&&(b.displayName="Breadcrumb")}}]);
//# sourceMappingURL=265.9545a0b8.chunk.js.map