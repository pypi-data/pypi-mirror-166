Metadata-Version: 2.1
Name: zash-sdk
Version: 0.0.5
Summary: SDK
Home-page: https://github.com/zashdev/zash-sdk
Author: efx
Author-email: efe@joinzash.com
License: Apache Software License 2.0
Keywords: nbdev jupyter notebook python
Platform: UNKNOWN
Classifier: Development Status :: 4 - Beta
Classifier: Intended Audience :: Developers
Classifier: Natural Language :: English
Classifier: Programming Language :: Python :: 3.7
Classifier: Programming Language :: Python :: 3.8
Classifier: Programming Language :: Python :: 3.9
Classifier: Programming Language :: Python :: 3.10
Classifier: License :: OSI Approved :: Apache Software License
Requires-Python: >=3.7
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: boto3
Requires-Dist: pandas
Requires-Dist: redshift-connector
Requires-Dist: dateparser
Requires-Dist: requests
Requires-Dist: fastcore
Requires-Dist: python-box
Requires-Dist: web3
Provides-Extra: dev

zash-sdk
================

<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

Delightful, ergonomic blockchain data SDK built for data scientist, ML
engineers and data analysts. Wrangle and explore transactions under a
minute.

## Install

``` sh
pip install zash-sdk
```

## Quickstart

### Authentication

Get your credentials from [zash.sh](https://zash.sh)

``` python
from zash_sdk.zash import Zash
zash = Zash('your_username', 'your_api_key')
```

    Authenticated!

### Accessing NFT collection trades

Grab all Bored Ape trades in x2y2 since yesterday (contract address
[here](https://etherscan.io/address/0xbc4ca0eda7647a8ab7c2061c2e118a18a936f13d)):

``` python
bayc = zash.nft('eth').collection('0xBC4CA0EdA7647A8aB7C2061c2E118A18a936f13D')
```

``` python
trades_df = bayc.trades('yesterday')
trades_df.query("marketplace_name == 'x2y2'").head()
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>hash</th>
      <th>buyer</th>
      <th>seller</th>
      <th>collection_address</th>
      <th>token_id</th>
      <th>marketplace_address</th>
      <th>marketplace_name</th>
      <th>price</th>
      <th>currency</th>
      <th>block_hash</th>
      <th>block_number</th>
      <th>mint</th>
      <th>bundle</th>
      <th>timestamp</th>
      <th>updated_at</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7</th>
      <td>c8c81cee-a23b-340f-bb4d-81298c1fbef3</td>
      <td>0x04d1b88921fa61e760cb55fe30e36efc346c9c313399...</td>
      <td>0x7bF481e3a1Dd55618AC58F874481A9eAa3231734</td>
      <td>0xed2ab4948bA6A909a7751DEc4F34f303eB8c7236</td>
      <td>0xBC4CA0EdA7647A8aB7C2061c2E118A18a936f13D</td>
      <td>7404</td>
      <td>0x74312363e45DCaBA76c59ec49a7Aa8A65a67EeD3</td>
      <td>x2y2</td>
      <td>72.00</td>
      <td>WETH</td>
      <td>0xf767a152a503621334ec7f07d0d784cf5d3f7ed2da23...</td>
      <td>15479591</td>
      <td>False</td>
      <td>False</td>
      <td>1662405470</td>
      <td>2022-09-05 19:31:20</td>
    </tr>
    <tr>
      <th>24</th>
      <td>a92becf0-de72-3b15-b34f-76ef1261d3e8</td>
      <td>0xf0b4bb46af36b3ee16110b1b50bf42ac481f82dc8109...</td>
      <td>0xed2ab4948bA6A909a7751DEc4F34f303eB8c7236</td>
      <td>0xaf0f4479aF9Df756b9b2c69B463214B9a3346443</td>
      <td>0xBC4CA0EdA7647A8aB7C2061c2E118A18a936f13D</td>
      <td>9425</td>
      <td>0x74312363e45DCaBA76c59ec49a7Aa8A65a67EeD3</td>
      <td>x2y2</td>
      <td>69.95</td>
      <td>ETH</td>
      <td>0x9ec1d48c818c5f8ad282cf33a4fc7a6b9fe7eaea5bb5...</td>
      <td>15479585</td>
      <td>False</td>
      <td>False</td>
      <td>1662405361</td>
      <td>2022-09-05 19:31:20</td>
    </tr>
    <tr>
      <th>39</th>
      <td>b14adc70-cdf8-399c-bc17-2a08e47a17a3</td>
      <td>0xc5fa6f1939d8b62024ab680b8ed747b719fca7be63d1...</td>
      <td>0x6cFdad0772EDC2EA15076A9706ec7c1F0a791aC1</td>
      <td>0xFACb9BB8f399c5548aFA36AB18B7E0e2b0F0C8c2</td>
      <td>0xBC4CA0EdA7647A8aB7C2061c2E118A18a936f13D</td>
      <td>4591</td>
      <td>0x74312363e45DCaBA76c59ec49a7Aa8A65a67EeD3</td>
      <td>x2y2</td>
      <td>70.00</td>
      <td>ETH</td>
      <td>0x22c7e0f6a69dbffd147395ab59bb491bed0d6ec30004...</td>
      <td>15480433</td>
      <td>False</td>
      <td>False</td>
      <td>1662417133</td>
      <td>2022-09-05 22:46:19</td>
    </tr>
    <tr>
      <th>62</th>
      <td>9e4991c3-bc6f-328b-b47f-d7126d0df2af</td>
      <td>0xc69a2089aecde6acc04ed4bdda5db2889abcb5b22ae3...</td>
      <td>0xF6a242191ca16FB561403182a2c7A023F2261eB7</td>
      <td>0xFF389e55ee4dD64D82B2b6FefEF3F7aA63B218fD</td>
      <td>0xBC4CA0EdA7647A8aB7C2061c2E118A18a936f13D</td>
      <td>5037</td>
      <td>0x74312363e45DCaBA76c59ec49a7Aa8A65a67EeD3</td>
      <td>x2y2</td>
      <td>71.00</td>
      <td>ETH</td>
      <td>0xa1c6b48d455cadfba86c685de592bd8f68c3f64f5361...</td>
      <td>15481645</td>
      <td>False</td>
      <td>False</td>
      <td>1662434301</td>
      <td>2022-09-06 03:31:29</td>
    </tr>
    <tr>
      <th>65</th>
      <td>6b6e1693-a5ec-36ae-9d67-117216e8aa18</td>
      <td>0xb6a42a0d54659210f5ba78cf8981377a9adf9b6e7ff1...</td>
      <td>0xad6452a9b8F10b0fE084C83c396ABAe96411C761</td>
      <td>0x6De3E88c9119Af0CfE2880f9758d76Aa95A9ec36</td>
      <td>0xBC4CA0EdA7647A8aB7C2061c2E118A18a936f13D</td>
      <td>4258</td>
      <td>0x74312363e45DCaBA76c59ec49a7Aa8A65a67EeD3</td>
      <td>x2y2</td>
      <td>85.00</td>
      <td>WETH</td>
      <td>0x1cb0864eacc179b4875dcffe9f7525c566a723a2f5bd...</td>
      <td>15482016</td>
      <td>False</td>
      <td>False</td>
      <td>1662439305</td>
      <td>2022-09-06 04:46:22</td>
    </tr>
  </tbody>
</table>
</div>

A closer look at a trade:

``` python
trade = trades_df.query("marketplace_name == 'x2y2'").head(1).squeeze()
trade
```

    id                                  c8c81cee-a23b-340f-bb4d-81298c1fbef3
    hash                   0x04d1b88921fa61e760cb55fe30e36efc346c9c313399...
    buyer                         0x7bF481e3a1Dd55618AC58F874481A9eAa3231734
    seller                        0xed2ab4948bA6A909a7751DEc4F34f303eB8c7236
    collection_address            0xBC4CA0EdA7647A8aB7C2061c2E118A18a936f13D
    token_id                                                            7404
    marketplace_address           0x74312363e45DCaBA76c59ec49a7Aa8A65a67EeD3
    marketplace_name                                                    x2y2
    price                                                               72.0
    currency                                                            WETH
    block_hash             0xf767a152a503621334ec7f07d0d784cf5d3f7ed2da23...
    block_number                                                    15479591
    mint                                                               False
    bundle                                                             False
    timestamp                                                     1662405470
    updated_at                                           2022-09-05 19:31:20
    Name: 7, dtype: object

``` python
# You can check out the transaction on etherscan:
!echo https://etherscan.io/tx/{trade['hash']}
```

    https://etherscan.io/tx/0x04d1b88921fa61e760cb55fe30e36efc346c9c313399b6c7775acb44b0ed320f

### Simple marketplace comparison

You can get near-real time view of a chain in a single line:

``` python
last_hour_trades = zash.nft('eth').trades('1 hour ago')
```

[`NFT.trades`](https://zashdev.github.io/nft.html#trades) accepts time
ranges or shortcuts such as “yesterday” or “today”.

``` python
# offmarket marketplaces are labelled as -
last_hour_trades\
    .query('marketplace_name != "-"')\
    .groupby('marketplace_name')\
    .agg({"price":'sum'})\
    .sort_values('price', ascending=False)\
    .plot(kind='bar', ylabel='price_in_eth', legend=False)
```

    <AxesSubplot:xlabel='marketplace_name', ylabel='price_in_eth'>

![](index_files/figure-gfm/cell-9-output-2.png)

## Example: Deep dive on BNB

In this example, we’ll show you can go from a macro view to a micro one,
from marketplaces all the way to the tokens.

Let’s look at BNB chain this time, across all marketplaces:

``` python
bnb = zash.nft('bnb')
trades = bnb.trades('1 hour ago')
```

Off-market trades are market with “-” in marketplace names, you can
filter them out as such:

``` python
marketplace_trades = trades.query('marketplace_name != "-"')
```

``` python
marketplace_trades.groupby('marketplace_name').agg({"price":'sum'}).plot(kind='bar')
```

    <AxesSubplot:xlabel='marketplace_name'>

![](index_files/figure-gfm/cell-12-output-2.png)

From here we see Element has the highest volume, can do a drill on this
to find out the top collections:

``` python
top = marketplace_trades.query("marketplace_name == 'element'")\
    .groupby('collection_address')\
    .sum('price')[['price']]\
    .sort_values('price', ascending=False)
top
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>price</th>
    </tr>
    <tr>
      <th>collection_address</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0xE3b1D32e43Ce8d658368e2CBFF95D57Ef39Be8a6</th>
      <td>3.9900</td>
    </tr>
    <tr>
      <th>0x9CEE09946A8113a503C1264e328c0e3aEe4c8bCf</th>
      <td>0.3000</td>
    </tr>
    <tr>
      <th>0x85F0e02cb992aa1F9F47112F815F519EF1A59E2D</th>
      <td>0.2000</td>
    </tr>
    <tr>
      <th>0xADc466855ebe8d1402C5F7e6706Fccc3AEdB44a0</th>
      <td>0.0110</td>
    </tr>
    <tr>
      <th>0xC2A19349D5f451071C3085B90f531D19F190FF21</th>
      <td>0.0099</td>
    </tr>
    <tr>
      <th>0x1e13BDCB500a9B24b8221B290aD5E535D34E4218</th>
      <td>0.0000</td>
    </tr>
  </tbody>
</table>
</div>

We see that `0xE3b1D32e43Ce8d658368e2CBFF95D57Ef39Be8a6` has the highest
volume as a collection. To find more about this collection we can grab
it and check it’s metadata:

``` python
bnb.collection('0xE3b1D32e43Ce8d658368e2CBFF95D57Ef39Be8a6').metadata()
```

    collection_id    0xe3b1d32e43ce8d658368e2cbff95d57ef39be8a6
    name                                               SPACE ID
    slug                                      space-id-bnb-name
    marketplace                                            tofu
    website_url                               https://space.id/
    discord_url                   https://discord.gg/cXP5UtYjHY
    twitter_url             https://twitter.com/SpaceIDProtocol
    floor_price                                           28.93
    updated_at                       2022-08-30 11:53:38.548041
    created_at                              2022-08-07 12:49:06
    Name: SPACE ID, dtype: object

We see it is Space ID! We even have Twitter, Discord and website
references to find more about this dapp/collection. Let’s do more
drilling on this, checking out what was the split on primary vs
secondary and also top mints traded can be a good idea:

``` python
spaceid = bnb.collection('0xE3b1D32e43Ce8d658368e2CBFF95D57Ef39Be8a6')
spaceid_trades = spaceid.trades('last month')
```

``` python
# can look at some price summary stats:
spaceid_trades['price'].describe()
```

    count    54230.000000
    mean         0.220979
    std          1.219418
    min          0.000000
    25%          0.008280
    50%          0.009268
    75%          0.037172
    max        123.000000
    Name: price, dtype: float64

Can check primary vs seconday split on volume:

``` python
spaceid_trades.groupby('mint').sum('price')[['price']].plot(kind='barh')
```

    <AxesSubplot:ylabel='mint'>

![](index_files/figure-gfm/cell-17-output-2.png)

We can also check for primary vs secondary trade counts…

``` python
spaceid_trades['mint'].value_counts(normalize=True).reset_index().style.format({'mint': "%{:.2f}"})
```

<style type="text/css">
</style>
<table id="T_72b57">
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_72b57_level0_col0" class="col_heading level0 col0" >index</th>
      <th id="T_72b57_level0_col1" class="col_heading level0 col1" >mint</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_72b57_level0_row0" class="row_heading level0 row0" >0</th>
      <td id="T_72b57_row0_col0" class="data row0 col0" >False</td>
      <td id="T_72b57_row0_col1" class="data row0 col1" >%0.57</td>
    </tr>
    <tr>
      <th id="T_72b57_level0_row1" class="row_heading level0 row1" >1</th>
      <td id="T_72b57_row1_col0" class="data row1 col0" >True</td>
      <td id="T_72b57_row1_col1" class="data row1 col1" >%0.43</td>
    </tr>
  </tbody>
</table>

So primary and secondary sale numbers are close but secondary sales
volume is almost 5x.

Next, we can check out also highest value token trade as an example:

``` python
top_trade = spaceid_trades\
    .query('mint == False')\
    .sort_values('price', ascending=False).head(1).squeeze()
top_trade
```

    id                                  56466d58-e366-3f96-8bd6-115f1054bf36
    hash                   0x99eceaa0a93e960f162f94b3248aadba2d280af4c245...
    buyer                         0x68CA671253729039c1596856A0492B5979FCF37b
    seller                        0xC25751a1cE2eE2F62599F3Cc238a874C631aa4FC
    collection_address            0xE3b1D32e43Ce8d658368e2CBFF95D57Ef39Be8a6
    token_id               4563769053854199209000009877284788645708242223...
    marketplace_address           0xb3e3DfCb2d9f3DdE16d78B9e6EB3538Eb32B5ae1
    marketplace_name                                                 element
    price                                                              123.0
    currency                                                             BNB
    block_hash             0xae31bce2d4f9e6442b83f41e47236ef56f970ba9c2c1...
    block_number                                                    21088593
    mint                                                               False
    bundle                                                             False
    timestamp                                                     1662447211
    updated_at                                           2022-09-06 07:01:48
    Name: 15223, dtype: object

If we are curious to get more info on this we can then grab this token
as such:

``` python
token = spaceid.token(top_trade.token_id)
pprint(token.metadata())
```

    {'attributes': BoxList([{'trait_type': 'Created Date', 'display_type': 'date', 'value': 1661401461}, {'trait_type': 'Registration Date', 'display_type': 'date', 'value': 1661401461}, {'trait_type': 'Expiration Date', 'display_type': 'date', 'value': 1692955724}, {'trait_type': 'Length', 'display_type': 'number', 'value': 3}, {'trait_type': 'Segment Length', 'display_type': 'number', 'value': 3}, {'trait_type': 'Character Set', 'display_type': 'string', 'value': 'digit'}]),
     'description': '123.bnb, a bnb name.',
     'image': 'https://meta.image.space.id/image/mainnet/45637690538541992090000098772847886457082422231295691457910964509567538102535.svg',
     'name': '123.bnb',
     'name_length': 3,
     'segment_length': 3,
     'uri': 'https://meta.space.id/45637690538541992090000098772847886457082422231295691457910964509567538102535'}

So this is `123.bnb` id!

We also have traits (can be used to calculate rarities for PFP/Gamefi
collections), and more info that can be accessed with the token model.

You can then also get the history of trades as such:

``` python
token_trades = token.trades('last month')
```

``` python
token_trades.sort_values('timestamp', ascending=True)
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>hash</th>
      <th>buyer</th>
      <th>seller</th>
      <th>collection_address</th>
      <th>token_id</th>
      <th>marketplace_address</th>
      <th>marketplace_name</th>
      <th>price</th>
      <th>currency</th>
      <th>block_hash</th>
      <th>block_number</th>
      <th>mint</th>
      <th>bundle</th>
      <th>timestamp</th>
      <th>updated_at</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>f072e372-518d-31b5-bd91-803162bb1d73</td>
      <td>0xe1e0ac10537fd5b2a723a3dedea6feb2223083bd83f1...</td>
      <td>0xC25751a1cE2eE2F62599F3Cc238a874C631aa4FC</td>
      <td>0x48af770f89F03C6cCea6919df6F89bC903cE2F9C</td>
      <td>0xE3b1D32e43Ce8d658368e2CBFF95D57Ef39Be8a6</td>
      <td>4563769053854199209000009877284788645708242223...</td>
      <td>0x48af770f89F03C6cCea6919df6F89bC903cE2F9C</td>
      <td>-</td>
      <td>0.0</td>
      <td>BNB</td>
      <td>0xf88eb7636afedda5a88dc8b4f6f53558052e5838941d...</td>
      <td>20739907</td>
      <td>False</td>
      <td>True</td>
      <td>1661398772</td>
      <td>2022-08-26 20:26:52</td>
    </tr>
    <tr>
      <th>1</th>
      <td>037e325f-8e64-355d-ad07-0c812d94ac39</td>
      <td>0xe1e0ac10537fd5b2a723a3dedea6feb2223083bd83f1...</td>
      <td>0x48af770f89F03C6cCea6919df6F89bC903cE2F9C</td>
      <td>0x0000000000000000000000000000000000000000</td>
      <td>0xE3b1D32e43Ce8d658368e2CBFF95D57Ef39Be8a6</td>
      <td>4563769053854199209000009877284788645708242223...</td>
      <td>0x48af770f89F03C6cCea6919df6F89bC903cE2F9C</td>
      <td>-</td>
      <td>0.0</td>
      <td>BNB</td>
      <td>0xf88eb7636afedda5a88dc8b4f6f53558052e5838941d...</td>
      <td>20739907</td>
      <td>True</td>
      <td>True</td>
      <td>1661398772</td>
      <td>2022-08-26 20:26:52</td>
    </tr>
    <tr>
      <th>2</th>
      <td>56466d58-e366-3f96-8bd6-115f1054bf36</td>
      <td>0x99eceaa0a93e960f162f94b3248aadba2d280af4c245...</td>
      <td>0x68CA671253729039c1596856A0492B5979FCF37b</td>
      <td>0xC25751a1cE2eE2F62599F3Cc238a874C631aa4FC</td>
      <td>0xE3b1D32e43Ce8d658368e2CBFF95D57Ef39Be8a6</td>
      <td>4563769053854199209000009877284788645708242223...</td>
      <td>0xb3e3DfCb2d9f3DdE16d78B9e6EB3538Eb32B5ae1</td>
      <td>element</td>
      <td>123.0</td>
      <td>BNB</td>
      <td>0xae31bce2d4f9e6442b83f41e47236ef56f970ba9c2c1...</td>
      <td>21088593</td>
      <td>False</td>
      <td>False</td>
      <td>1662447211</td>
      <td>2022-09-06 07:01:48</td>
    </tr>
  </tbody>
</table>
</div>

Apparently, there was only a single mint (combined with a transfer to
the owner) and then a secondary sale worth \~\$34,194.

Wrapping up, this was just an example of how from gross analysis you can
go to token level in just a few lines. Let us know how we can improve
the docs if you have any [ideas](mailto:efe@joinzash.com).

## Advanced

### Network analysis on trades

We are building and enriching network analysis tools to be go deeper on
a given trade network. Below is a flavor of what is to come.

``` python
from zash_sdk.graph import *
network = build_network(bayc.trades('yesterday'))
plot_trade_network(network)
```

![](index_files/figure-gfm/cell-23-output-1.png)

You can filter for wash trades (triangular or bidirectional cycles for
instance).

### Stay tuned!

This is the beginning of what you can do with Zash SDK. We would be
adding transparent NFT price prediction and wallet based analysis tools
in the upcoming weeks. If you have any feature requests [get in
touch](mailto:efe@joinzash.com). We are also
[hiring](https://northern-steel-324.notion.site/Zash-is-Hiring-d5e19210b944486c8fd11f385a176999)!


